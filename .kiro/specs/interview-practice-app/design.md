# é¢æ¥ç·´ç¿’ã‚¢ãƒ—ãƒª - æŠ€è¡“è¨­è¨ˆæ›¸

## ğŸ“ ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ¦‚è¦

### è¨­è¨ˆåŸå‰‡ï¼ˆã‚³ã‚¢ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ï¼‰
1. **AIãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é¢æ¥**: Gemini APIã«ã‚ˆã‚‹å‹•çš„è³ªå•ç”Ÿæˆã§ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é¢æ¥ã‚’å†ç¾
2. **æ®µéšçš„æ·±å €ã‚Šã‚¨ãƒ³ã‚¸ãƒ³**: 7-9å±¤ã®è³ªå•ãƒã‚§ãƒ¼ãƒ³è‡ªå‹•ç”ŸæˆæŠ€è¡“
3. **ä¸é©åˆ‡å›ç­”AIæ¤œå‡º**: ã€Œå¾è¼©ã¯çŒ«ã§ã‚ã‚‹ã€ç­‰ã®ãµã–ã‘ãŸå›ç­”ã‚’è‡ªå‹•åˆ¤å®šãƒ»æŒ‡å°
4. **æ´»å‹•ã‚¿ã‚¤ãƒ—åˆ¥AIå¯¾å¿œ**: ç§‘å­¦ç³»ãƒ»èŠ¸è¡“ç³»ç­‰ã®6ãƒ‘ã‚¿ãƒ¼ãƒ³ã§è³ªå•ã‚’ç‰¹åŒ–
5. **å°å­¦ç”Ÿç‰¹åŒ–UI**: ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆæœ€é©åŒ–ã€å¤§å‹ã‚¿ãƒƒãƒã‚¿ãƒ¼ã‚²ãƒƒãƒˆã€éŸ³å£°ãƒ¡ã‚¤ãƒ³
6. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ AIè©•ä¾¡**: æ˜å’Œä¸­7è»¸è©•ä¾¡ã«ã‚ˆã‚‹å³åº§ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
7. **æ–‡è„ˆç†è§£AI**: å—æ¤œç”Ÿå›ç­”ã‹ã‚‰é‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è‡ªå‹•æŠ½å‡ºãƒ»æ´»ç”¨
8. **ãƒãƒ«ãƒAIå†—é•·åŒ–**: Geminiéšœå®³æ™‚ã®GPT-4/Claudeè‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ

## ğŸ—ï¸ AIãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é¢æ¥ã‚·ã‚¹ãƒ†ãƒ  ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 1. ã‚³ã‚¢AIã‚¨ãƒ³ã‚¸ãƒ³ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
[å—æ¤œç”Ÿå›ç­”] â†’ [ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡ºAI] â†’ [æ´»å‹•ã‚¿ã‚¤ãƒ—è­˜åˆ¥] â†’ [æ·±æ˜ã‚Šã‚¿ãƒ¼ã‚²ãƒƒãƒˆç‰¹å®š]
      â†“                 â†“                  â†“                    â†“
[Gemini API]      [æ–‡è„ˆç†è§£å‡¦ç†]      [6æ´»å‹•ãƒ‘ã‚¿ãƒ¼ãƒ³]      [7-9å±¤è³ªå•ç”Ÿæˆ]
      â†“                 â†“                  â†“                    â†“
[å‹•çš„è³ªå•ç”Ÿæˆ]    [ä¸é©åˆ‡å›ç­”æ¤œå‡º]    [æ®µéšç§»è¡Œåˆ¤å®š]       [ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è©•ä¾¡]
      â†“                 â†“                  â†“                    â†“
[AIãƒãƒ£ãƒƒãƒˆå‡ºåŠ›] â† [å»ºè¨­çš„æŒ‡å°] â† [æ¢ç©¶æ·±åº¦ç®¡ç†] â† [æ˜å’Œ7è»¸ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯]
```

### 2. å…¨ä½“ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
[ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ/ã‚¹ãƒãƒ›] â†â†’ [PWA Frontend] â†â†’ [Next.js API] â†â†’ [AIã‚¨ãƒ³ã‚¸ãƒ³ç¾¤]
       â†“                    â†“                   â†“                 â†“
[éŸ³å£°èªè­˜]            [ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ UI]      [è³ªå•ç”ŸæˆAPI]    [Gemini 2.5 Flash]
[ã‚¿ãƒƒãƒUI]            [çŠ¶æ³è¡¨ç¤º]          [è©•ä¾¡API]        [GPT-4 Fallback]
[PWA Cache]           [é€²æ—ç®¡ç†]          [ä¸é©åˆ‡æ¤œå‡ºAPI]   [Claude Fallback]
```

### 3. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆPWAï¼‰
- **Core**: Next.js 14 + React 18 + TypeScript 5.0+
- **Styling**: Tailwind CSS (å°å­¦ç”Ÿç‰¹åŒ–ã€44pxä»¥ä¸Šã‚¿ãƒƒãƒã‚¿ãƒ¼ã‚²ãƒƒãƒˆ)
- **State Management**: React Hook + Context APIï¼ˆè»½é‡ï¼‰
- **PWA**: Service Workerï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³éŸ³å£°èªè­˜å¯¾å¿œï¼‰
- **Audio**: Web Speech APIï¼ˆéŸ³å£°ãƒ¡ã‚¤ãƒ³å…¥åŠ›ï¼‰
- **Build Tool**: Next.js built-in optimizations

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Framework**: Next.js 14 API Routes + TypeScript
- **ORM**: Prismaï¼ˆSQLiteé–‹ç™º / PostgreSQLæœ¬ç•ªï¼‰
- **Security**: å€‹äººæƒ…å ±æš—å·åŒ–ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€CORSå¯¾å¿œ

## ğŸ¤– ã‚³ã‚¢AIæŠ€è¡“ä»•æ§˜

### 1. å‹•çš„ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³è³ªå•ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³

#### ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡ºã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
```typescript
function extractSpecificKeywords(response: string): string[] {
  const highPriorityPatterns = [
    /ç’°å¢ƒå§”å“¡ä¼š|ç”Ÿå¾’ä¼š|å§”å“¡ä¼š|éƒ¨æ´»å‹•|ã‚¯ãƒ©ãƒ–æ´»å‹•/g,
    /ãƒ¡ãƒ€ã‚«|æ¤ç‰©|å‹•ç‰©|æ°´è³ª|pHå€¤|ãƒ€ãƒ³ã‚¹|éŸ³æ¥½|ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°/g
  ];
  
  const mediumPriorityPatterns = [
    /è¦³å¯Ÿ|è¨˜éŒ²|æ¸¬å®š|å®Ÿé¨“|èª¿æŸ»|ç ”ç©¶|åˆ†æ/g,
    /å°å­¦[1-6]å¹´ç”Ÿ|[1-9]å¹´é–“|æ¯æ—¥|é€±[1-7]å›|ç¶™ç¶š/g,
    /å›°é›£|å¤§å¤‰|é›£ã—ã„|å¤±æ•—|ã†ã¾ãã„ã‹ãªã„|æŒ«æŠ˜/g
  ];
  
  // å„ªå…ˆåº¦é †ã§æœ€å¤§5å€‹ã¾ã§æŠ½å‡º
  return extractByPriority(response, [highPriorityPatterns, mediumPriorityPatterns]);
}
```

#### æ´»å‹•ã‚¿ã‚¤ãƒ—è­˜åˆ¥ã‚·ã‚¹ãƒ†ãƒ 
```typescript
function identifyActivityType(response: string): ActivityType {
  const typePatterns = {
    'ç§‘å­¦ãƒ»å€‹äººç ”ç©¶ç³»': /ãƒ¡ãƒ€ã‚«|æ¤ç‰©|å‹•ç‰©|æ°´è³ª|pH|å®Ÿé¨“|è¦³å¯Ÿ|è‚²æˆ/,
    'èŠ¸è¡“ãƒ»å”åƒç³»': /ãƒ€ãƒ³ã‚¹|éŸ³æ¥½|æ¼”åŠ‡|ç¾è¡“|ãƒãƒ¼ãƒ |ã‚°ãƒ«ãƒ¼ãƒ—|ç™ºè¡¨/,
    'ã‚¹ãƒãƒ¼ãƒ„ãƒ»ç«¶æŠ€ç³»': /ã‚µãƒƒã‚«ãƒ¼|é‡çƒ|ãƒã‚¹ã‚±|è¨˜éŒ²|ã‚¿ã‚¤ãƒ |ç·´ç¿’|è©¦åˆ/,
    'æŠ€è¡“ãƒ»å‰µé€ ç³»': /ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°|ãƒ­ãƒœãƒƒãƒˆ|ã‚¢ãƒ—ãƒª|é›»å­å·¥ä½œ|ä½œã‚‹/,
    'ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ç³»': /ç”Ÿå¾’ä¼š|å§”å“¡é•·|ä»£è¡¨|ãƒªãƒ¼ãƒ€ãƒ¼|ä¼ç”»|é‹å–¶/
  };
  
  // ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã§æ´»å‹•ã‚¿ã‚¤ãƒ—ã‚’è‡ªå‹•è­˜åˆ¥
  return matchActivityType(response, typePatterns);
}
```

#### 7-9å±¤æ·±æ˜ã‚Šè³ªå•ç”Ÿæˆ
```typescript
async function generateInquiryDeepDiveQuestion(context): Promise<string> {
  const extractedKeywords = extractSpecificKeywords(lastResponse);
  const activityType = identifyActivityType(lastResponse);
  const deepDiveTargets = identifyDeepDiveTargets(lastResponse);
  
  const prompt = `
  ã€æ˜å’Œä¸­AIãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é¢æ¥ã‚·ã‚¹ãƒ†ãƒ ã€‘
  
  å—æ¤œç”Ÿå›ç­”: "${lastResponse}"
  æŠ½å‡ºã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ${extractedKeywords.join('ã€')}
  æ´»å‹•ã‚¿ã‚¤ãƒ—: ${activityType}
  æ·±æ˜ã‚Šã‚¿ãƒ¼ã‚²ãƒƒãƒˆ: ${deepDiveTargets.join('ã€')}
  
  å®Ÿéš›ã®åˆæ ¼è€…é¢æ¥ãƒ¬ãƒ™ãƒ«ã®è³ªå•æŠ€è¡“ã§7-9å±¤æ·±æ˜ã‚Šè³ªå•ã‚’ç”Ÿæˆ:
  - å—æ¤œç”Ÿã®ç™ºè¨€ã‹ã‚‰å…·ä½“çš„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å¿…ãšæ´»ç”¨
  - "${extractedKeywords[0]}ã«ã¤ã„ã¦ã€œã§ã™ã­"ã§ç™ºè¨€ã‚’å—ã‘æ­¢ã‚ã‚‹
  - ãã®å¾Œ"ã€œã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã‹ï¼Ÿ"ã§æ·±æ˜ã‚Šã™ã‚‹
  - æ´»å‹•ã‚¿ã‚¤ãƒ—åˆ¥ã®å°‚é–€çš„è³ªå•ã‚’ã™ã‚‹
  `;
  
  return await geminiAPI.generate(prompt);
}
```

### 2. ä¸é©åˆ‡å›ç­”AIæ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ 

```typescript
async function checkInappropriateAnswer(question: string, answer: string) {
  const prompt = `
  ã€æ˜å’Œä¸­é¢æ¥ï¼šå›ç­”é©åˆ‡æ€§AIåˆ¤å®šã€‘
  
  è³ªå•: "${question}"
  å—æ¤œç”Ÿå›ç­”: "${answer}"
  
  ä¸é©åˆ‡ãªä¾‹: ãµã–ã‘ãŸå†…å®¹ï¼ˆã€Œå¾è¼©ã¯çŒ«ã§ã‚ã‚‹ã€ã€Œé©å½“ã«ã€ç­‰ï¼‰
  
  åˆ¤å®šçµæœã‚’JSONå½¢å¼ã§å‡ºåŠ›:
  {
    "inappropriate": true/false,
    "reason": "åˆ¤å®šç†ç”±"
  }
  `;
  
  const result = await geminiAPI.generate(prompt);
  return JSON.parse(result);
}
```

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **Development**: SQLite 3.40+ (ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã€è»½é‡)
- **Production**: PostgreSQL 15+ (Prismaäº’æ›ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«)
- **Cache**: Redis 7.0+ (ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™)

#### AIã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆã‚³ã‚¢æŠ€è¡“ï¼‰
- **ãƒ¡ã‚¤ãƒ³AI**: Gemini 2.5 Flashï¼ˆå‹•çš„ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³è³ªå•ç”Ÿæˆï¼‰
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ãƒãƒ«ãƒAIå¯¾å¿œï¼ˆOpenAI GPT-4, Claude 3.5ï¼‰
- **ã‚³ã‚¢æ©Ÿèƒ½**: 
  - å—æ¤œç”Ÿå›ç­”ã®æ–‡è„ˆç†è§£ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º
  - æ´»å‹•ã‚¿ã‚¤ãƒ—è­˜åˆ¥ï¼ˆç§‘å­¦ç³»ã€èŠ¸è¡“ç³»ã€ã‚¹ãƒãƒ¼ãƒ„ç³»ç­‰ï¼‰
  - 7-9å±¤ã®æ®µéšçš„æ·±å €ã‚Šè³ªå•è‡ªå‹•ç”Ÿæˆ
  - ä¸é©åˆ‡å›ç­”æ¤œå‡ºãƒ»å»ºè¨­çš„æŒ‡å°
- **éŸ³å£°å‡¦ç†**: Google Cloud Speech-to-Text + Azure Speech Serviceï¼ˆé«˜ç²¾åº¦éŸ³å£°èªè­˜ï¼‰
- **éŸ³å£°åˆæˆ**: ElevenLabsï¼ˆè‡ªç„¶ãªæ—¥æœ¬èªéŸ³å£°åˆæˆï¼‰
- **File Storage**: AWS S3 + CloudFront CDNï¼ˆé«˜é€Ÿé…ä¿¡ï¼‰
- **Monitoring**: DataDogï¼ˆåŒ…æ‹¬çš„ç›£è¦–ãƒ»åˆ†æï¼‰
- **Error Tracking**: Sentryï¼ˆè©³ç´°ã‚¨ãƒ©ãƒ¼åˆ†æï¼‰

### 3. ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
[Cloudflare Pro] â†’ [AWS ALB] â†’ [ECS Fargate] â†’ [RDS PostgreSQL]
      â†“              â†“            â†“                â†“
[Global CDN]    [Auto Scaling]  [Service Mesh]  [Read Replicas]
[DDoS Protection] [Health Check] [Blue/Green]   [Automated Backup]
                                     â†“
                              [ElastiCache Redis Cluster]
                                     â†“
                    [External APIs: OpenAI, Claude, Google Cloud]
```

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### 1. ERå›³ï¼ˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–¢ä¿‚å›³ï¼‰

```
Users (1) â†â†’ (N) InterviewSessions (N) â†â†’ (1) Schools
  â†“                      â†“
ApplicationEssays    SessionQuestions
  â†“                      â†“
EssayAnalysis       QuestionResponses
```

### 2. ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ

#### Users ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  student_name VARCHAR(100) NOT NULL,
  grade INTEGER NOT NULL DEFAULT 6,
  target_school_id UUID REFERENCES schools(id),
  parent_email VARCHAR(255),
  parent_consent BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  last_login_at TIMESTAMP,
  
  -- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ç®¡ç†
  data_retention_until DATE NOT NULL,
  consent_version INTEGER NOT NULL DEFAULT 1
);
```

#### Schools ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆæ•™è‚²ç†å¿µãƒ‡ãƒ¼ã‚¿ï¼‰
```sql
CREATE TABLE schools (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(100) UNIQUE NOT NULL,
  code VARCHAR(50) UNIQUE NOT NULL, -- 'meiwa', 'kariya', etc.
  mission TEXT NOT NULL,
  
  -- é¢æ¥å‚¾å‘ãƒ‡ãƒ¼ã‚¿ï¼ˆJSONï¼‰
  interview_patterns JSONB NOT NULL,
  essay_structure JSONB NOT NULL,
  
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ApplicationEssays ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå¿—é¡˜ç†ç”±æ›¸ï¼‰
```sql
CREATE TABLE application_essays (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  
  -- å¿—é¡˜ç†ç”±æ›¸4é …ç›®
  motivation TEXT, -- å¿—æœ›å‹•æ©Ÿ
  research_activities TEXT, -- æ¢ç©¶æ´»å‹•
  school_life_goals TEXT, -- å­¦æ ¡ç”Ÿæ´»æŠ±è² 
  future_goals TEXT, -- å°†æ¥ç›®æ¨™
  
  -- AIåˆ†æçµæœ
  analysis_result JSONB,
  
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### InterviewSessions ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE interview_sessions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  school_id UUID NOT NULL REFERENCES schools(id),
  essay_id UUID REFERENCES application_essays(id),
  
  session_type VARCHAR(50) NOT NULL, -- 'practice', 'mock_exam'
  duration_seconds INTEGER,
  completed_at TIMESTAMP,
  
  -- è©•ä¾¡ã‚¹ã‚³ã‚¢
  overall_score DECIMAL(3,2), -- 1.00-5.00
  section_scores JSONB, -- é …ç›®åˆ¥ã‚¹ã‚³ã‚¢
  
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### SessionQuestions ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE session_questions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  session_id UUID NOT NULL REFERENCES interview_sessions(id) ON DELETE CASCADE,
  question_number INTEGER NOT NULL,
  question_text TEXT NOT NULL,
  question_type VARCHAR(50) NOT NULL, -- 'motivation', 'research', etc.
  
  -- AIç”Ÿæˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿  
  generation_prompt TEXT,
  tokens_used INTEGER,
  
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### QuestionResponses ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE question_responses (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  question_id UUID NOT NULL REFERENCES session_questions(id) ON DELETE CASCADE,
  
  response_text TEXT NOT NULL,
  response_duration_seconds INTEGER,
  input_method VARCHAR(20) NOT NULL, -- 'voice', 'keyboard'
  
  -- AIè©•ä¾¡çµæœ
  evaluation_result JSONB,
  feedback_text TEXT,
  score DECIMAL(3,2),
  
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 3. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ

```sql
-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
CREATE INDEX idx_users_email ON users(email);

-- å…ˆé€²æ©Ÿèƒ½ç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_sessions_user_created ON interview_sessions(user_id, created_at);
CREATE INDEX idx_responses_session_created ON user_responses(session_id, created_at);
CREATE INDEX idx_essays_user_version ON essays(user_id, version);

-- AIè©•ä¾¡çµæœæ¤œç´¢ç”¨
CREATE INDEX idx_responses_evaluation_score ON user_responses USING GIN (evaluation_result);
CREATE INDEX idx_sessions_performance_metrics ON interview_sessions USING GIN (performance_metrics);
```

## 4. å®Ÿéš›é¢æ¥å†ç¾ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ

### 4.1 å¯¾è©±ãƒ•ãƒ­ãƒ¼ç®¡ç†ã‚¨ãƒ³ã‚¸ãƒ³

```typescript
// å®Ÿéš›é¢æ¥ã®4æ®µéšãƒ•ãƒ­ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
interface DialogueFlowEngine {
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†
  sessionState: {
    currentStage: 'opening' | 'exploration' | 'metacognition' | 'future';
    currentDepth: number; // 1-6 (æ·±å €ã‚Šãƒ¬ãƒ™ãƒ«)
    timeElapsed: number;
    stageTimeAllocation: {
      opening: 180000; // 3åˆ†
      exploration: 600000; // 10åˆ†
      metacognition: 120000; // 2åˆ†
      future: 60000; // 1åˆ†
    };
    explorationFocus: string; // ç¾åœ¨æ·±å €ã‚Šä¸­ã®ãƒˆãƒ”ãƒƒã‚¯
    questionTree: QuestionNode[];
    responseHistory: InterviewResponse[];
    evaluationProgress: StageEvaluation[];
  };

  // æ®µéšé·ç§»ãƒ­ã‚¸ãƒƒã‚¯
  stageTransition: {
    openingToExploration: {
      trigger: 'basic_info_completed';
      condition: 'name_and_travel_confirmed';
      autoAdvance: true;
    };
    explorationDeepening: {
      trigger: 'response_analysis_complete';
      condition: 'depth_under_max_level';
      strategy: 'context_aware_follow_up';
    };
    explorationToMetacognition: {
      trigger: 'exploration_time_threshold';
      condition: 'sufficient_exploration_data';
      transition: 'natural_bridge_question';
    };
    metacognitionToFuture: {
      trigger: 'metacognitive_understanding_confirmed';
      condition: 'time_remaining_sufficient';
      finalStage: true;
    };
  };

  // è‡ªç„¶ãªä¼šè©±ãƒ•ãƒ­ãƒ¼ç”Ÿæˆ
  conversationFlow: {
    contextPreservation: boolean;
    emotionalContinuity: boolean;
    topicCoherence: boolean;
    personalizedReferences: boolean;
  };
}

interface QuestionNode {
  id: string;
  stage: InterviewStage;
  depthLevel: number;
  parentQuestionId?: string;
  questionTemplate: string;
  followUpTriggers: string[]; // ç‰¹å®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ·±å €ã‚Šç™ºå‹•
  maxDepth: number;
  evaluationFocus: string[];
  realInterviewFrequency: number; // å®Ÿéš›ã®é¢æ¥ã§ã®å‡ºç¾é »åº¦
  problemSolvingFocus: boolean;
  metacognitiveFocus: boolean;
}
```

### 4.2 æ®µéšçš„æ·±å €ã‚Šè³ªå•ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 

```typescript
// å®Ÿéš›é¢æ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ™ãƒ¼ã‚¹è³ªå•ç”Ÿæˆ
interface StagedQuestioningSystem {
  // å®Ÿéš›é¢æ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
  realInterviewPatterns: {
    openingQuestions: {
      basicInfo: [
        "å—é¨“ç•ªå·ã¨åå‰ã‚’æ•™ãˆã¦ãã ã•ã„",
        "ä»Šæ—¥ã¯ã©ã†ã‚„ã£ã¦æ¥ã‚‰ã‚Œã¾ã—ãŸã‹ï¼Ÿ"
      ];
      travelDetails: [
        "é›»è»Šã¯ä½•ã«ä¹—ã£ã¦ï¼Ÿ",
        "ã©ã“ã§ä¹—ã‚Šæ›ãˆã¾ã—ãŸã‹ï¼Ÿ",
        "ãŠæ¯ã•ã‚“ã¨ä¸€ç·’ã«ï¼Ÿ"
      ];
      relaxationTechniques: [
        "ç·Šå¼µã—ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ",
        "å­¦æ ¡ã¯è¦‹ã¤ã‘ã‚„ã™ã‹ã£ãŸã§ã™ã‹ï¼Ÿ"
      ];
    };

    explorationQuestions: {
      initialPrompt: "å¿—é¡˜ç†ç”±æ›¸ã«æ›¸ã„ã¦ã‚ã‚‹â—‹â—‹ã«ã¤ã„ã¦ã€ä»Šã‹ã‚‰1åˆ†å·®ã—ä¸Šã’ã¾ã™ã€‚èª¬æ˜ã‚’ã—ã¦ãã ã•ã„ã€‚";
      
      depthProgression: {
        level1_trigger: {
          pattern: "â—‹â—‹ã‚’å§‹ã‚ãŸãã£ã‹ã‘ã¯ä½•ã§ã™ã‹ï¼Ÿ";
          analysisTarget: "motivation_and_context";
          realExamples: [
            "ãƒ€ãƒ³ã‚¹ã‚’å§‹ã‚ãŸãã£ã‹ã‘ã¯ä½•ã§ã™ã‹ï¼Ÿ",
            "ãã®ç ”ç©¶ã‚’å§‹ã‚ã‚ˆã†ã¨æ€ã£ãŸã®ã¯ãªãœï¼Ÿ"
          ];
        };
        
        level2_environment: {
          pattern: "ãã®æ™‚ã©ã‚“ãªçŠ¶æ³ã§ã—ãŸã‹ï¼Ÿ";
          analysisTarget: "environmental_context";
          realExamples: [
            "å¹¼å°‘æœŸã‹ã‚‰éŸ³æ¥½ã‚’è´ã„ã¦éŸ³ã«ä¹—ã£ã¦è¸Šã‚‹ã“ã¨ãŒå¥½ãã§",
            "æ¯ãŒã‚„ã£ã¦ã¿ãŸã‚‰ã©ã†ã¨å‹§ã‚ã¦ãã‚Œã¦"
          ];
        };

        level3_collaboration: {
          pattern: "èª°ã¨ä¸€ç·’ã«å–ã‚Šçµ„ã¿ã¾ã—ãŸã‹ï¼Ÿ";
          analysisTarget: "collaborative_aspects";
          realExamples: [
            "ã‚ãªãŸãŒæ‰€å±ã—ã¦ã„ã‚‹ãƒ€ãƒ³ã‚¹ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ã¯ä½•äººã„ã‚‰ã£ã—ã‚ƒã„ã¾ã™ã‹ï¼Ÿ",
            "è¬›å¸«ã®å…ˆç”Ÿã¯ä½•äººã„ã‚‰ã£ã—ã‚ƒã„ã¾ã™ã‹ï¼Ÿ"
          ];
        };

        level4_challenges: {
          pattern: "ã†ã¾ãã„ã‹ãªã„æ™‚ã¯ã©ã†ã—ã¾ã—ãŸã‹ï¼Ÿ";
          analysisTarget: "problem_solving_approach";
          realExamples: [
            "è©±ã—åˆã„ã§è§£æ±ºã§ããªã„å ´åˆã©ã†ã—ã¾ã—ãŸã‹ï¼Ÿ",
            "èª²é¡Œã«ãªã£ãŸæŒ¯ä»˜ã«ã°ã‚‰ã¤ããŒã‚ã‚Šãã‚ã‚ãªã‹ã£ãŸéš›ã€å…·ä½“çš„ã«ã©ã†ã„ã†è¡Œå‹•ã‚’ã—ã¾ã—ãŸã‹ï¼Ÿ"
          ];
        };

        level5_specific_actions: {
          pattern: "å…·ä½“çš„ã«ã©ã‚“ãªè¡Œå‹•ã‚’ã—ã¾ã—ãŸã‹ï¼Ÿ";
          analysisTarget: "concrete_problem_solving";
          realExamples: [
            "æœ€åˆã«ã¾ãšé¡ãªã—ã§è¸Šã£ã¦ã€è‡ªåˆ†ãŸã¡ã®æŒ¯ä»˜ã‚’ç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸ",
            "ãã“ã§æŒ¯ã‚ŠãŒãã‚ã£ã¦ã„ãªã„ã¨ã“ã‚ã‚„ã“ã“ã§éŸ³ã¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒãšã‚Œã¦ã„ã‚‹ãªã©ã®èª²é¡Œã‚’ãƒ¡ãƒ³ãƒãƒ¼ã¿ã‚“ãªã§ç¢ºèª"
          ];
        };

        level6_interpersonal: {
          pattern: "ä»²é–“ã¨æ„è¦‹ãŒé•ã£ãŸæ™‚ã¯ã©ã†ã—ã¾ã—ãŸã‹ï¼Ÿ";
          analysisTarget: "interpersonal_problem_solving";
          realExamples: [
            "ä»²é–“ã¨å”åŠ›ã—ã¦ã‚‚æ„è¦‹ãŒåˆã‚ãšå¯¾ç«‹ã—ãŸå ´åˆã€ã‚ãªãŸã¯ã©ã®ã‚ˆã†ãªè¡Œå‹•ã‚’ã—ã¾ã™ã‹ï¼Ÿ",
            "ãã®ã¨ãã€è‡ªåˆ†ã®æ­£ç›´ãªæ°—æŒã¡ã‚’ä»²é–“ã«ä¼ãˆãŸã‚Šã™ã‚‹ã‚“ã§ã™ã‹ï¼Ÿ"
          ];
        };
      };
    };

    metacognitionQuestions: {
      connectionDiscovery: [
        "ãƒ€ãƒ³ã‚¹ã¨æ¢ç©¶æ´»å‹•ã¯ã©ã®ã‚ˆã†ãªç‚¹ãŒä¼¼ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
        "â—‹â—‹ã¨â—‹â—‹ã®å…±é€šç‚¹ã¯ä½•ã ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ"
      ];
      learningProcess: [
        "ç­”ãˆãŒãªã„ã“ã¨ã«ã¤ã„ã¦ã©ã†æ€ã„ã¾ã™ã‹ï¼Ÿ",
        "ã©ã‚“ãªå­¦ã³ãŒã‚ã‚Šã¾ã—ãŸã‹ï¼Ÿ"
      ];
      selfReflection: [
        "ã“ã®çµŒé¨“ã§ã‚ãªãŸè‡ªèº«ã¯ã©ã†å¤‰ã‚ã‚Šã¾ã—ãŸã‹ï¼Ÿ",
        "è©±ã›ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã¯ãªãœã ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ"
      ];
    };

    futureConnection: {
      nextInquiry: [
        "æ­´å²ã«ã¤ã„ã¦æ¢ç©¶ã‚’ã—ãŸã„ã¨æ›¸ã„ã¦ãŠã‚‰ã‚Œã¾ã™ãŒã€ã©ã®ã‚ˆã†ãªæ¢ç©¶æ´»å‹•ã‚’ã—ã¦å­¦ã‚“ã§ã„ããŸã„ã§ã™ã‹ï¼Ÿ",
        "ã“ã‚Œã‹ã‚‰èª¿ã¹ãŸã„ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ"
      ];
      motivation: [
        "ãã‚Œã¯ãªãœã§ã™ã‹ï¼Ÿ",
        "ãªãœãã®ãƒ†ãƒ¼ãƒã«èˆˆå‘³ã‚’æŒã£ãŸã®ã§ã™ã‹ï¼Ÿ"
      ];
      socialConnection: [
        "ãã‚Œã¯ç¾ä»£ã¨ã©ã†ç¹‹ãŒã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
        "ç¤¾ä¼šã«ã©ã‚“ãªå½±éŸ¿ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ"
      ];
    };
  };

  // å‹•çš„è³ªå•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯
  questionGeneration: {
    contextAwareGeneration: boolean;
    personalizedReferences: boolean;
    naturalTransitions: boolean;
    problemSolvingFocus: boolean;
    metacognitiveTriggers: boolean;
  };

  // æ·±å €ã‚Šãƒ•ãƒ­ãƒ¼åˆ¶å¾¡ï¼ˆæ‹¡å¼µç‰ˆï¼‰
  depthControl: {
    maxDepthPerTopic: 9; // æ‹¡å¼µï¼šæœ€å¤§9å±¤ã¾ã§å¯¾å¿œ
    adaptiveDepthAdjustment: boolean;
    timeBasedDepthControl: boolean;
    qualityBasedProgression: boolean;
    preparationTimeManagement: boolean; // æ–°æ©Ÿèƒ½ï¼šæº–å‚™æ™‚é–“ç®¡ç†
    inquiryFieldAdaptation: boolean; // æ–°æ©Ÿèƒ½ï¼šæ¢ç©¶åˆ†é‡åˆ¥é©å¿œ
  };

  // æ–°æ©Ÿèƒ½ï¼šæº–å‚™æ™‚é–“é…æ…®ã‚·ã‚¹ãƒ†ãƒ 
  preparationTimeSystem: {
    oneMinuteExplanationPrep: {
      offerPreparationTime: boolean;
      maxPreparationTime: 30000; // 30ç§’
      userChoiceDetection: 'voice-or-gesture-based';
      encouragingMessage: "æ•´ç†ã™ã‚‹æ™‚é–“ãŒå°‘ã—ã»ã—ã„ã‚ˆã†ãªã‚‰å·®ã—ä¸Šã’ã¾ã™";
    };
    adaptiveTimeAllocation: {
      userPaceDetection: boolean;
      timeExtensionLogic: boolean;
      naturalFlowMaintenance: boolean;
    };
  };

  // æ–°æ©Ÿèƒ½ï¼šæ¢ç©¶åˆ†é‡åˆ¥ãƒ‘ã‚¿ãƒ¼ãƒ³é©å¿œ
  inquiryFieldPatterns: {
    artCollaborativePattern: {
      focus: ['collaboration', 'dialogue', 'conflict_resolution'];
      questionProgression: 'team_dynamics_focused';
      evaluationCriteria: 'interpersonal_skills_weighted';
    };
    scienceIndividualPattern: {
      focus: ['problem_solving', 'information_gathering', 'failure_learning'];
      questionProgression: 'research_process_focused';
      evaluationCriteria: 'systematic_thinking_weighted';
    };
    adaptivePatternSelection: {
      keywordBasedDetection: boolean;
      contentAnalysisTriggering: boolean;
      dynamicPatternSwitching: boolean;
    };
  };
}
```

### 4.3 èª²é¡Œè§£æ±ºãƒ—ãƒ­ã‚»ã‚¹è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 

```typescript
// å®Ÿéš›é¢æ¥ã§é‡è¦è¦–ã•ã‚Œã‚‹èª²é¡Œè§£æ±ºèƒ½åŠ›ã®è©•ä¾¡
interface ProblemSolvingEvaluationSystem {
  // å•é¡Œèªè­˜ãƒ»å®šç¾©èƒ½åŠ›
  problemIdentification: {
    evaluationCriteria: {
      problemClarity: number; // å•é¡Œã®æ˜ç¢ºãªèªè­˜åº¦
      stakeholderAwareness: number; // é–¢ä¿‚è€…ã¸ã®ç†è§£
      contextUnderstanding: number; // çŠ¶æ³æŠŠæ¡åŠ›
    };
    realExamples: {
      danceExample: "æŒ¯ä»˜ãŒãã‚ã‚ãªã„ãªã©ã®æ§˜ã€…ãªèª²é¡Œ";
      researchExample: "è³‡æ–™ãŒè¦‹ã¤ã‹ã‚‰ãªã„";
      teamExample: "æ„è¦‹ãŒå¯¾ç«‹ã—ã¦ã—ã¾ã£ãŸ";
    };
  };

  // è§£æ±ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒè©•ä¾¡
  solutionApproach: {
    evaluationCriteria: {
      creativityLevel: number; // å‰µé€ çš„è§£æ±ºåŠ›
      systematicThinking: number; // ä½“ç³»çš„æ€è€ƒ
      resourceUtilization: number; // è³‡æºæ´»ç”¨åŠ›
      processClarity: number; // ãƒ—ãƒ­ã‚»ã‚¹ã®æ˜ç¢ºæ€§
    };
    realExamples: {
      systematicApproach: "ã¾ãšé¡ãªã—ã§è¸Šã£ã¦ç¢ºèªâ†’èª²é¡Œç‰¹å®šâ†’é¡ã§ç·´ç¿’â†’å†ç¢ºèª";
      expertConsultation: "å°‚é–€ã®ã‚¸ãƒ£ãƒ³ãƒ«ã‚’æ‰±ã£ã¦ã„ã‚‹å…ˆç”ŸãŸã¡ã«è³ªå•";
      iterativeImprovement: "ç·´ç¿’â†’ç¢ºèªâ†’ç·´ç¿’ã®ã‚µã‚¤ã‚¯ãƒ«";
    };
  };

  // å”åƒãƒ»å¯¾è©±ãƒ—ãƒ­ã‚»ã‚¹è©•ä¾¡
  collaborativeProcess: {
    evaluationCriteria: {
      communicationSkill: number; // ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èƒ½åŠ›
      conflictResolution: number; // å¯¾ç«‹è§£æ±ºåŠ›
      emotionalIntelligence: number; // æ„Ÿæƒ…çš„çŸ¥æ€§
      leadershipPotential: number; // ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ç´ è³ª
    };
    realExamples: {
      conflictResolution: "å¯¾ç«‹ã—ã¦ã—ã¾ã£ãŸäººåŒå£«ã®æ„è¦‹ã‚’ã¾ãšèã";
      emotionalExpression: "æ€ã£ã¦ã„ã‚‹ã“ã¨ã‚’ä¼ãˆã¦ã„ãã¹ãã ãª";
      consensusBuilding: "ä¸€ã¤ã®è§£æ±ºç­–ã«ã—ã¦ã‹ã‚‰ã¿ã‚“ãªã«ä¼ãˆã‚‹";
    };
  };

  // å­¦ã³ãƒ»æˆé•·æŠ½å‡ºè©•ä¾¡
  learningExtraction: {
    evaluationCriteria: {
      reflectiveThinking: number; // æŒ¯ã‚Šè¿”ã‚Šæ€è€ƒ
      growthMindset: number; // æˆé•·ãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆ
      transferability: number; // è»¢ç§»å¯èƒ½æ€§
      articulation: number; // è¨€èªåŒ–èƒ½åŠ›
    };
    realExamples: {
      selfTransformation: "è©±ã›ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ";
      processLearning: "ä»²é–“ãŒã„ãŸã‹ã‚‰ã“ãã®çµæœ";
      continuousImprovement: "è‡ªåˆ†ãŸã¡ãªã‚Šã®ç­”ãˆã‚’è¦‹ã¤ã‘ã¦ã„ã";
    };
  };

  // æ–°æ©Ÿèƒ½ï¼šå¤±æ•—å­¦ç¿’ã‚µã‚¤ã‚¯ãƒ«è©•ä¾¡
  failureLearningCycle: {
    evaluationCriteria: {
      failureAcceptance: number; // å¤±æ•—å—å®¹åº¦
      learningExtraction: number; // å¤±æ•—ã‹ã‚‰ã®å­¦ã³æŠ½å‡º
      resilience: number; // å›å¾©åŠ›ãƒ»ç«‹ã¡ç›´ã‚Š
      retryMotivation: number; // å†æŒ‘æˆ¦æ„æ¬²
    };
    realExamples: {
      failureAcknowledgment: "2ã€3ã‹æœˆã§æ­»ã‚“ã§ã—ã¾ã£ãŸ";
      learningReflection: "ã“ã®å¤±æ•—ã‚’å™›ã¿ã—ã‚ã¦";
      retryIntent: "ã‚‚ã†ä¸€åº¦é£¼è‚²ã‚’è©¦ã¿ã‚ˆã†ã‹ãª";
      systematicApproach: "ä»Šåº¦ã¯ã‚‚ã£ã¨æƒ…å ±ã‚’é›†ã‚ã¦";
    };
  };

  // æ–°æ©Ÿèƒ½ï¼šæƒ…å ±åé›†ãƒ—ãƒ­ã‚»ã‚¹è©•ä¾¡
  informationGatheringProcess: {
    evaluationCriteria: {
      sourceIdentification: number; // æƒ…å ±æºç‰¹å®šèƒ½åŠ›
      systematicApproach: number; // ä½“ç³»çš„åé›†ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
      expertConsultation: number; // å°‚é–€å®¶æ´»ç”¨èƒ½åŠ›
      multiSourceValidation: number; // è¤‡æ•°æºæ¤œè¨¼èƒ½åŠ›
    };
    realExamples: {
      expertConsultation: "é³¥ç¾½æ°´æ—é¤¨ã«è¡Œã£ã¦èã„ãŸ";
      localResource: "è¿‘å ´ã®ãƒšãƒƒãƒˆã‚·ãƒ§ãƒƒãƒ—ã§èª¿ã¹ãŸ";
      systematicInquiry: "ã„ã‚ã‚“ãªã¨ã“ã‚ã«èãè¾¼ã¿ã«è¡Œã£ãŸ";
      familySupport: "ãŠçˆ¶ã•ã‚“ã¨ä¸€ç·’ã«é ãã¾ã§";
    };
  };

  // æ–°æ©Ÿèƒ½ï¼šå¶ç„¶ç™ºè¦‹æ´»ç”¨è©•ä¾¡
  serendipityUtilization: {
    evaluationCriteria: {
      opportunityRecognition: number; // æ©Ÿä¼šèªè­˜åŠ›
      curiosityTriggering: number; // å¥½å¥‡å¿ƒç™ºå‹•åŠ›
      explorationDevelopment: number; // æ¢ç©¶ç™ºå±•åŠ›
      connectionMaking: number; // é–¢é€£ä»˜ã‘èƒ½åŠ›
    };
    realExamples: {
      accidentalDiscovery: "é‡£ã£ãŸã‚‰ãŸã¾ãŸã¾ã™ã”ã„ã§ã‹ã„è²ãŒé‡£ã‚Œã¦";
      interestTriggering: "ãã“ã«å¼•ã£ä»˜ã„ã¦ãŸ";
      explorationEvolution: "ãã‚ŒãŒãã£ã‹ã‘ã§ã‚¦ãƒŸã‚¦ã‚·é£¼è‚²ã‚’å§‹ã‚ãŸ";
      systematicDevelopment: "ãã“ã‹ã‚‰æœ¬æ ¼çš„ã«ç ”ç©¶ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ";
    };
  };

  // æ–°æ©Ÿèƒ½ï¼šå€‹äººçš„é–¢å¿ƒæ·±åŒ–è©•ä¾¡
  personalInterestDevelopment: {
    evaluationCriteria: {
      emotionalAttachment: number; // æ„Ÿæƒ…çš„æ„›ç€åº¦
      logicalUnderstanding: number; // è«–ç†çš„ç†è§£åº¦
      experientialEngagement: number; // ä½“é¨“çš„é–¢ä¸åº¦
      perspectiveEvolution: number; // è¦–ç‚¹ç™ºå±•åº¦
    };
    realExamples: {
      emotionalConnection: "ã™ã”ãã‹ã‚ã„ãã¦";
      logicalAppreciation: "æ·±æµ·ã®ã™ã”ã„æ°´åœ§ã«ã‚‚è€ãˆã¦ã¦";
      activeEngagement: "æ²¼æ´¥æ¸¯æ·±æµ·æ°´æ—é¤¨ã«è¡Œã£ã¦è¦‹ã¾ã—ãŸ";
      surpriseDiscovery: "æ¡ˆå¤–çµæ§‹å‹•ãå›ã£ã¦ãŸã€ãã‚ŒãŒã¡ã‚‡ã£ã¨æ„å¤–";
      conceptualGrowth: "ã‹ã£ã“ã„ã„é¢ã‚‚ã‚ã‚‹ã—ã€ã‹ã‚ã„ã„é¢ã‚‚ã‚ã‚‹";
    };
  };
}
```

### 4.4 ãƒ¡ã‚¿èªçŸ¥è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 

```typescript
// é«˜æ¬¡æ€è€ƒåŠ›ãƒ»ãƒ¡ã‚¿èªçŸ¥èƒ½åŠ›ã®æŠ€è¡“çš„è©•ä¾¡
interface MetacognitiveEvaluationSystem {
  // é–¢é€£æ€§ç™ºè¦‹èƒ½åŠ›
  connectionDiscovery: {
    evaluationCriteria: {
      abstractThinking: number; // æŠ½è±¡åŒ–æ€è€ƒåŠ›
      patternRecognition: number; // ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜åŠ›
      analogicalReasoning: number; // é¡æ¨çš„æ¨è«–åŠ›
      conceptualBridging: number; // æ¦‚å¿µé–“æ©‹æ¸¡ã—åŠ›
    };
    realExampleAnalysis: {
      question: "ãƒ€ãƒ³ã‚¹ã¨æ¢ç©¶æ´»å‹•ã¯ã©ã®ã‚ˆã†ãªç‚¹ãŒä¼¼ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ";
      expectedResponse: "ç­”ãˆãŒãªã„ã¨ã“ã‚ãŒå…±é€šã—ã¦ã„ã‚‹";
      evaluationPoints: [
        "èª²é¡Œã‚’è‡ªåˆ†ãŸã¡ã§è¦‹ã¤ã‘ã‚‹",
        "å¿…è¦ãªæƒ…å ±ã‚’è‡ªåˆ†ãŸã¡ã§é›†ã‚ã‚‹",
        "å®Ÿè·µã—ã¦ã¿ã‚‹",
        "è‡ªåˆ†ãŸã¡ãªã‚Šã®ç­”ãˆã‚’è¦‹ã¤ã‘ã¦ã„ã"
      ];
    };
  };

  // å­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ç†è§£
  learningProcessUnderstanding: {
    evaluationCriteria: {
      processAwareness: number; // ãƒ—ãƒ­ã‚»ã‚¹è‡ªè¦šåŠ›
      strategicThinking: number; // æˆ¦ç•¥çš„æ€è€ƒåŠ›
      selfRegulation: number; // è‡ªå·±èª¿æ•´åŠ›
      adaptiveLearning: number; // é©å¿œçš„å­¦ç¿’åŠ›
    };
    realExampleAnalysis: {
      cycleRecognition: "èª²é¡Œç™ºè¦‹â†’æƒ…å ±åé›†â†’å®Ÿè·µâ†’åçœã®ã‚µã‚¤ã‚¯ãƒ«";
      strategicAdjustment: "é¡ãªã—â†’é¡ã‚ã‚Šâ†’é¡ãªã—ã®ç·´ç¿’æˆ¦ç•¥";
      collaborativeLearning: "è©±ã—åˆã„â†’å°‚é–€å®¶ç›¸è«‡â†’å®Ÿè·µçµ±åˆ";
    };
  };

  // ç­”ãˆã®ãªã„å•é¡Œã¸ã®å–ã‚Šçµ„ã¿æ–¹ç†è§£
  openEndedProblemApproach: {
    evaluationCriteria: {
      ambiguityTolerance: number; // æ›–æ˜§ã•è€æ€§
      exploratoryMindset: number; // æ¢ç©¶çš„ãƒã‚¤ãƒ³ãƒ‰
      iterativeImprovement: number; // åå¾©æ”¹å–„åŠ›
      emergentSolutionCreation: number; // å‰µç™ºçš„è§£æ±ºå‰µé€ åŠ›
    };
    realExampleAnalysis: {
      question: "ç­”ãˆãŒãªã„ã“ã¨ã«ã¤ã„ã¦ã©ã†æ€ã„ã¾ã™ã‹ï¼Ÿ";
      evaluationFocus: [
        "æ¢ç©¶æ€§ãƒ»éæ­£è§£æ€§ã®ç†è§£",
        "ãƒ—ãƒ­ã‚»ã‚¹é‡è¦–ã®å§¿å‹¢",
        "ç¶™ç¶šçš„æŒ‘æˆ¦ã®æ„æ¬²",
        "å¤šæ§˜æ€§å—å®¹ã®æ…‹åº¦"
      ];
    };
  };
}
```

## 5. å…ˆé€²çš„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### 5.1 ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```typescript
// å®Ÿéš›é¢æ¥å†ç¾ç‰¹åŒ–ã‚µãƒ¼ãƒ“ã‚¹åˆ†é›¢æ§‹æˆ
interface MicroserviceArchitecture {
  // å¯¾è©±ãƒ•ãƒ­ãƒ¼ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹
  dialogueFlowService: {
    endpoint: '/api/dialogue-flow';
    features: [
      'stage-progression-management',    // 4æ®µéšé€²è¡Œç®¡ç†
      'depth-control-system',           // 5-6å±¤æ·±å €ã‚Šåˆ¶å¾¡
      'natural-conversation-flow',      // è‡ªç„¶ãªä¼šè©±ç¶™ç¶š
      'context-preservation'            // æ–‡è„ˆä¿æŒ
    ];
    processing: 'stateful-session-based';
    latency: '<100ms';
  };

  // æ®µéšçš„è³ªå•ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹
  stagedQuestioningService: {
    endpoint: '/api/staged-questions';
    features: [
      'real-interview-pattern-matching', // å®Ÿéš›é¢æ¥ãƒ‘ã‚¿ãƒ¼ãƒ³é©ç”¨
      'depth-progressive-generation',    // æ®µéšçš„æ·±å €ã‚Šè³ªå•ç”Ÿæˆ
      'problem-solving-focus',          // èª²é¡Œè§£æ±ºç‰¹åŒ–è³ªå•
      'metacognitive-triggering'        // ãƒ¡ã‚¿èªçŸ¥è³ªå•ç™ºå‹•
    ];
    model: 'GPT-4-Turbo + Claude-3.5';
    responseTime: '<3s';
  };

  // èª²é¡Œè§£æ±ºè©•ä¾¡ã‚µãƒ¼ãƒ“ã‚¹
  problemSolvingEvaluationService: {
    endpoint: '/api/problem-solving-eval';
    features: [
      'problem-identification-analysis',  // å•é¡Œèªè­˜è©•ä¾¡
      'solution-approach-assessment',     // è§£æ±ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒè©•ä¾¡
      'collaborative-process-evaluation', // å”åƒãƒ—ãƒ­ã‚»ã‚¹è©•ä¾¡
      'learning-extraction-measurement'   // å­¦ã³æŠ½å‡ºè©•ä¾¡
    ];
    processing: 'multi-criteria-analysis';
    realTimeScoring: true;
  };

  // ãƒ¡ã‚¿èªçŸ¥è©•ä¾¡ã‚µãƒ¼ãƒ“ã‚¹
  metacognitiveEvaluationService: {
    endpoint: '/api/metacognitive-eval';
    features: [
      'connection-discovery-assessment',    // é–¢é€£æ€§ç™ºè¦‹è©•ä¾¡
      'learning-process-understanding',     // å­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ç†è§£è©•ä¾¡
      'open-ended-problem-approach',        // ç­”ãˆãªã—å•é¡Œå–çµ„è©•ä¾¡
      'abstract-thinking-measurement'       // æŠ½è±¡æ€è€ƒæ¸¬å®š
    ];
    processing: 'high-order-thinking-analysis';
    complexityLevel: 'advanced';
  };

  // éŸ³å£°å‡¦ç†ã‚µãƒ¼ãƒ“ã‚¹
  speechService: {
    endpoint: '/api/speech';
    features: [
      'realtime-recognition',  // Whisper API
      'voice-synthesis',       // ElevenLabs API
      'emotion-analysis'       // Azure Cognitive Services
    ];
    latency: '<50ms';
  };

  // å®Ÿéš›é¢æ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒ“ã‚¹
  realInterviewPatternService: {
    endpoint: '/api/real-interview-patterns';
    features: [
      'interview-pattern-retrieval',     // é¢æ¥ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢
      'question-frequency-analysis',     // è³ªå•é »åº¦åˆ†æ
      'stage-timing-optimization',       // æ®µéšã‚¿ã‚¤ãƒŸãƒ³ã‚°æœ€é©åŒ–
      'pattern-matching-accuracy'        // ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ç²¾åº¦
    ];
    dataSource: 'verified-interview-transcripts';
    updateFrequency: 'continuous-learning';
  };

  // æ–°æ©Ÿèƒ½ï¼šæº–å‚™æ™‚é–“ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹
  preparationTimeManagementService: {
    endpoint: '/api/preparation-time';
    features: [
      'time-offering-detection',         // æº–å‚™æ™‚é–“æä¾›åˆ¤æ–­
      'user-readiness-assessment',       // ãƒ¦ãƒ¼ã‚¶ãƒ¼æº–å‚™åº¦è©•ä¾¡
      'adaptive-time-allocation',        // é©å¿œçš„æ™‚é–“é…åˆ†
      'natural-flow-maintenance'         // è‡ªç„¶ãªæµã‚Œç¶­æŒ
    ];
    processing: 'real-time-user-state-analysis';
    responsiveness: '<200ms';
  };

  // æ–°æ©Ÿèƒ½ï¼šæ‹¡å¼µè©•ä¾¡ã‚µãƒ¼ãƒ“ã‚¹
  extendedEvaluationService: {
    endpoint: '/api/extended-evaluation';
    features: [
      'failure-learning-cycle-assessment',    // å¤±æ•—å­¦ç¿’ã‚µã‚¤ã‚¯ãƒ«è©•ä¾¡
      'information-gathering-evaluation',     // æƒ…å ±åé›†ãƒ—ãƒ­ã‚»ã‚¹è©•ä¾¡
      'serendipity-utilization-analysis',     // å¶ç„¶ç™ºè¦‹æ´»ç”¨è©•ä¾¡
      'personal-interest-development-tracking' // å€‹äººçš„é–¢å¿ƒæ·±åŒ–è©•ä¾¡
    ];
    processing: 'multi-dimensional-advanced-analysis';
    realTimeScoring: true;
    depthLayers: 9; // 9å±¤æ·±å €ã‚Šå¯¾å¿œ
  };

  // æ–°æ©Ÿèƒ½ï¼šæ¢ç©¶åˆ†é‡é©å¿œã‚µãƒ¼ãƒ“ã‚¹
  inquiryFieldAdaptationService: {
    endpoint: '/api/inquiry-field-adaptation';
    features: [
      'field-pattern-detection',         // åˆ†é‡ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
      'art-collaborative-optimization',  // èŠ¸è¡“ãƒ»å”åƒç³»æœ€é©åŒ–
      'science-individual-optimization', // ç†ç§‘ãƒ»å€‹äººç ”ç©¶ç³»æœ€é©åŒ–
      'dynamic-pattern-switching'        // å‹•çš„ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ‡ã‚Šæ›¿ãˆ
    ];
    processing: 'content-analysis-based-adaptation';
    supportedFields: ['art-collaborative', 'science-individual', 'hybrid'];
  };
}
```

### 5.2 å®Ÿéš›é¢æ¥å†ç¾AI/MLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ

```typescript
// å®Ÿéš›é¢æ¥åŸºæº–å¤šæ¬¡å…ƒè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
interface RealInterviewBasedEvaluation {
  // 4æ®µéšåˆ¥è©•ä¾¡ã‚¨ãƒ³ã‚¸ãƒ³
  stageBasedAnalysis: {
    openingStageEvaluation: {
      basicResponseAbility: number;        // åŸºæœ¬å¿œç­”èƒ½åŠ›
      communicationPoise: number;          // ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³å§¿å‹¢
      relaxationLevel: number;             // ãƒªãƒ©ãƒƒã‚¯ã‚¹åº¦
      clarityOfExpression: number;         // è¡¨ç¾æ˜ç­æ€§
    };
    
    explorationStageEvaluation: {
      meiwaSevenCriteria: {
        genuineInterest: number;           // çœŸã®èˆˆå‘³ãƒ»é–¢å¿ƒåº¦
        experienceBase: number;            // ä½“é¨“ãƒ»å­¦ã³åŸºç›¤æ€§
        socialConnection: number;          // ç¤¾ä¼šãƒ»æ—¥å¸¸é€£çµæ€§
        noDefinitiveAnswer: number;        // æ¢ç©¶æ€§ãƒ»éæ­£è§£æ€§
        otherUnderstanding: number;        // ä»–è€…ç†è§£ãƒ»å…±æ„Ÿå¯èƒ½æ€§
        selfTransformation: number;        // è‡ªå·±å¤‰å®¹ãƒ»æˆé•·å®Ÿæ„Ÿ
        originalExpression: number;        // è‡ªåˆ†ã®è¨€è‘‰è¡¨ç¾åŠ›
      };
      depthProgressionQuality: number;     // æ·±å €ã‚Šå¯¾å¿œå“è³ª
      concreteEpisodeRichness: number;     // å…·ä½“çš„ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰è±Šå¯Œã•
      naturalDialogueFlow: number;         // è‡ªç„¶ãªå¯¾è©±æˆç«‹åº¦
    };
    
    metacognitionStageEvaluation: {
      connectionDiscoveryAbility: number;  // é–¢é€£æ€§ç™ºè¦‹èƒ½åŠ›
      learningProcessUnderstanding: number; // å­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ç†è§£
      abstractThinkingCapacity: number;    // æŠ½è±¡åŒ–æ€è€ƒåŠ›
      selfReflectionDepth: number;         // è‡ªå·±çœå¯Ÿæ·±åº¦
    };
    
    futureStageEvaluation: {
      continuousLearningMotivation: number; // ç¶™ç¶šå­¦ç¿’æ„æ¬²
      socialAwareness: number;             // ç¤¾ä¼šæ€§èªè­˜
      goalClarity: number;                 // ç›®æ¨™æ˜ç¢ºæ€§
      connectionToCurrentInterests: number; // ç¾åœ¨èˆˆå‘³ã¨ã®é–¢é€£æ€§
    };
  };

  // èª²é¡Œè§£æ±ºãƒ—ãƒ­ã‚»ã‚¹ç‰¹åŒ–è©•ä¾¡
  problemSolvingEvaluation: {
    problemIdentificationClarity: number;  // å•é¡Œèªè­˜æ˜ç¢ºæ€§
    solutionApproachCreativity: number;    // è§£æ±ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒå‰µé€ æ€§
    systematicThinking: number;            // ä½“ç³»çš„æ€è€ƒ
    collaborativeProcessSkill: number;     // å”åƒãƒ—ãƒ­ã‚»ã‚¹æŠ€èƒ½
    resourceUtilizationEffectiveness: number; // è³‡æºæ´»ç”¨åŠ¹æœæ€§
    learningExtractionAbility: number;     // å­¦ã³æŠ½å‡ºèƒ½åŠ›
  };

  // æ·±å €ã‚Šå¯¾è©±å“è³ªè©•ä¾¡
  depthDialogueQuality: {
    contextualContinuity: number;          // æ–‡è„ˆçš„ç¶™ç¶šæ€§
    naturalResponseFlow: number;           // è‡ªç„¶ãªå¿œç­”ãƒ•ãƒ­ãƒ¼
    depthProgressionSmoothness: number;    // æ·±å €ã‚Šé€²è¡Œã‚¹ãƒ ãƒ¼ã‚ºæ€§
    questionUnderstandingAccuracy: number; // è³ªå•ç†è§£ç²¾åº¦
    appropriateDetailLevel: number;        // é©åˆ‡ãªè©³ç´°ãƒ¬ãƒ™ãƒ«
    emotionalEngagement: number;           // æ„Ÿæƒ…çš„é–¢ä¸åº¦
  };

  // çµ±åˆã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆå®Ÿéš›é¢æ¥åŸºæº–ãƒ»æ‹¡å¼µç‰ˆï¼‰
  realInterviewScoring: {
    overallInterviewPerformance: number;   // ç·åˆé¢æ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
    interviewFlowSimilarity: number;       // å®Ÿéš›é¢æ¥ãƒ•ãƒ­ãƒ¼é¡ä¼¼åº¦
    depthDialogueCapability: number;       // æ·±å €ã‚Šå¯¾è©±èƒ½åŠ›ï¼ˆ9å±¤å¯¾å¿œï¼‰
    problemSolvingDemonstration: number;   // èª²é¡Œè§£æ±ºå®Ÿè¨¼åŠ›
    metacognitiveThinkingLevel: number;    // ãƒ¡ã‚¿èªçŸ¥æ€è€ƒãƒ¬ãƒ™ãƒ«
    naturalConversationAbility: number;    // è‡ªç„¶ä¼šè©±èƒ½åŠ›
    ageAppropriateAdjustment: number;      // å¹´é½¢é©å¿œèª¿æ•´
    improvementFromPreviousSessions: number; // å‰å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰ã®æ”¹å–„
    
    // æ–°æ©Ÿèƒ½ï¼šæ‹¡å¼µè©•ä¾¡é …ç›®
    failureLearningMaturity: number;       // å¤±æ•—å­¦ç¿’æˆç†Ÿåº¦
    informationGatheringSystematicity: number; // æƒ…å ±åé›†ä½“ç³»æ€§
    serendipityCapitalization: number;     // å¶ç„¶ç™ºè¦‹æ´»ç”¨åŠ›
    personalInterestEvolution: number;     // å€‹äººçš„é–¢å¿ƒç™ºå±•åº¦
    preparationTimeUtilization: number;    // æº–å‚™æ™‚é–“æ´»ç”¨åŠ¹æœ
    inquiryFieldSpecialization: number;    // æ¢ç©¶åˆ†é‡ç‰¹åŒ–åº¦
    
    // åˆ†é‡åˆ¥é‡ã¿ä»˜ã‘
    weightingByInquiryField: {
      artCollaborativeWeighting: {
        interpersonalSkills: 0.4;
        collaborativeProcess: 0.3;
        conflictResolution: 0.2;
        creativeExpression: 0.1;
      };
      scienceIndividualWeighting: {
        systematicThinking: 0.3;
        informationGathering: 0.25;
        failureLearning: 0.2;
        personalInterest: 0.15;
        serendipityUtilization: 0.1;
      };
    };
  };
}
```

### 5.3 å®Ÿéš›é¢æ¥å¯¾è©±ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡è¨­è¨ˆ

```typescript
// å®Ÿéš›é¢æ¥ãƒ•ãƒ­ãƒ¼å¯¾å¿œãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ 
interface RealInterviewRealtimeDialogueSystem {
  // 4æ®µéšé€²è¡Œç®¡ç†
  stageProgressionManagement: {
    openingStageFlow: {
      basicInfoCollection: 'natural-paced-questioning',
      travelDetailInquiry: 'follow-up-based-progression',
      relaxationTechniques: 'empathetic-response-integration',
      transitionToExploration: 'smooth-topic-shift'
    };
    explorationStageFlow: {
      oneMinuteExplanationTimer: 'visual-audio-countdown',
      depthProgressionControl: 'response-quality-based-advancement',
      problemSolvingFocus: 'challenge-solution-emphasis',
      collaborativeExperienceDeepening: 'interpersonal-skill-probing'
    };
    metacognitionStageFlow: {
      connectionDiscoveryPrompting: 'similarity-finding-facilitation',
      learningProcessReflection: 'meta-level-thinking-encouragement',
      openEndedProblemDiscussion: 'ambiguity-comfort-assessment'
    };
    futureStageFlow: {
      nextInquiryExploration: 'future-oriented-questioning',
      motivationClarification: 'deeper-interest-understanding',
      socialConnectionAwareness: 'real-world-relevance-discussion'
    };
  };

  // æ®µéšçš„æ·±å €ã‚Šåˆ¶å¾¡
  depthProgressionControl: {
    contextualQuestionGeneration: {
      userResponseAnalysis: 'real-time-content-parsing',
      followUpTriggerDetection: 'keyword-pattern-recognition',
      depthLevelProgression: 'natural-conversation-based',
      personalizedReferencing: 'user-specific-detail-integration'
    };
    naturalTransitionManagement: {
      topicContinuity: 'seamless-conversation-flow',
      emotionalToneConsistency: 'empathetic-response-maintenance',
      timingOptimization: 'appropriate-pace-management',
      clarificationHandling: 'understanding-confirmation'
    };
  };

  // WebRTCéŸ³å£°é€šä¿¡ï¼ˆå®Ÿéš›é¢æ¥ç‰¹åŒ–ï¼‰
  audioStreamOptimization: {
    protocol: 'WebRTC',
    codec: 'Opus',
    latency: '<50ms',
    quality: '48kHz-stereo',
    adaptiveBitrate: true,
    interviewEnvironmentOptimization: {
      noiseReduction: 'interview-room-acoustic-simulation',
      clarityEnhancement: 'small-voice-amplification',
      emotionPreservation: 'natural-tone-maintenance'
    }
  };

  // å¯¾è©±ãƒ•ãƒ­ãƒ¼ç¶™ç¶šæ€§
  conversationFlowContinuity: {
    sessionStateManagement: 'comprehensive-context-preservation',
    responseHistoryIntegration: 'previous-answer-referencing',
    personalityConsistency: 'ai-interviewer-character-maintenance',
    empathyIntegration: 'emotional-support-when-needed'
  };
}
```

### 5.4 å®Ÿéš›é¢æ¥AIé¢æ¥å®˜ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

```typescript
// é©å¿œå‹AIé¢æ¥å®˜ã‚·ã‚¹ãƒ†ãƒ 
interface AdaptiveInterviewerSystem {
  // 9ã¤ã®é¢æ¥å®˜ãƒšãƒ«ã‚½ãƒŠ
  interviewerPersonas: {
    encouraging: {
      tone: 'warm-supportive',
      questionStyle: 'leading-questions',
      feedback: 'positive-reinforcement'
    },
    analytical: {
      tone: 'precise-thoughtful',
      questionStyle: 'detailed-probing',
      feedback: 'specific-improvements'
    },
    friendly: {
      tone: 'casual-approachable',
      questionStyle: 'conversational',
      feedback: 'encouraging-guidance'
    }
    // ... 6 additional personas
  };

  // æ„Ÿæƒ…èªè­˜é©å¿œ
  emotionalAdaptation: {
    nervousness: 'slower-pace-encouragement',
    confidence: 'challenging-questions',
    confusion: 'clarification-examples',
    fatigue: 'energy-boost-humor'
  };

  // è¨˜æ†¶ãƒ»ç¶™ç¶šå­¦ç¿’
  memorySystem: {
    sessionHistory: 'comprehensive-tracking',
    improvementPatterns: 'learning-curve-analysis',
    preferences: 'interaction-style-adaptation',
    goals: 'personalized-milestone-setting'
  };
}
```

### 5.5 é¢æ¥ç·´ç¿’ç‰¹åŒ–ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

```typescript
// é€²æ—ãƒ»å‹•æ©Ÿã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ
interface GamificationEngine {
  // XPãƒã‚¤ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
  pointSystem: {
    basePoints: {
      sessionCompletion: 100,
      qualityImprovement: 50,
      streakMaintenance: 25,
      peerHelpgiving: 75
    },
    multipliers: {
      consecutiveDays: 'x1.5',
      difficultQuestions: 'x2.0',
      perfectScores: 'x3.0'
    }
  };

  // ãƒãƒƒã‚¸ãƒ»å®Ÿç¸¾ã‚·ã‚¹ãƒ†ãƒ 
  achievementSystem: {
    skillBadges: [
      'eloquent-speaker',
      'confident-presenter',
      'story-teller',
      'quick-thinker'
    ],
    progressBadges: [
      'first-session',
      '10-sessions',
      '50-sessions',
      'month-streak'
    ],
    specialBadges: [
      'early-bird',      // æœç·´ç¿’
      'night-owl',       // å¤œç·´ç¿’
      'weekend-warrior', // é€±æœ«ç·´ç¿’
      'perfect-score'    // æº€ç‚¹é”æˆ
    ]
  };

  // ãƒªãƒ¼ã‚°ãƒ»ç«¶äº‰ã‚·ã‚¹ãƒ†ãƒ 
  competitionSystem: {
    leagues: ['Bronze', 'Silver', 'Gold', 'Platinum', 'Diamond'],
    matching: 'skill-level-based',
    privacy: 'anonymous-leaderboard',
    rewards: 'league-specific-badges'
  };
}
```

### 4.6 ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼é‡è¦–è¨­è¨ˆ

```typescript
// Google Interview Warmupå‹ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚·ã‚¹ãƒ†ãƒ 
interface PrivacyFirstArchitecture {
  // ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†å„ªå…ˆ
  localProcessing: {
    speechRecognition: 'browser-whisper-wasm',
    basicEvaluation: 'client-side-ml',
    temporaryStorage: 'indexeddb-encrypted',
    automaticCleanup: 'session-end-purge'
  };

  // å·®åˆ†ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼
  differentialPrivacy: {
    dataAggregation: 'noise-injection',
    learningData: 'anonymized-patterns',
    modelTraining: 'federated-learning',
    insights: 'population-level-only'
  };

  // ãƒ‡ãƒ¼ã‚¿æœ€å°åŒ–
  dataMinimization: {
    collection: 'purpose-limited',
    retention: '30-day-maximum',
    processing: 'on-demand-only',
    sharing: 'never-third-party'
  };
}
```

## 5. APIè¨­è¨ˆã®æ‹¡å¼µ

### 5.1 å…ˆé€²éŸ³å£°å‡¦ç†API

```typescript
// ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°å‡¦ç†ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
interface AdvancedSpeechAPI {
  // Whisperãƒ™ãƒ¼ã‚¹éŸ³å£°èªè­˜
  '/api/speech/recognize': {
    method: 'POST | WebSocket',
    input: {
      audioStream: 'WebRTC-stream',
      language: 'ja-JP',
      interimResults: true,
      speakerDiarization: false
    },
    output: {
      finalTranscript: string,
      interimTranscript: string,
      confidence: number,
      emotions: EmotionAnalysis,
      speechMetrics: SpeechQualityMetrics
    }
  };

  // ElevenLabséŸ³å£°åˆæˆ
  '/api/speech/synthesize': {
    method: 'POST',
    input: {
      text: string,
      voice: InterviewerPersona,
      emotion: EmotionalTone,
      speed: number
    },
    output: {
      audioURL: string,
      duration: number,
      waveform: number[]
    }
  };
}
```

### 5.2 é«˜åº¦è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ API

```typescript
// 25ãƒã‚¤ãƒ³ãƒˆè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
interface ComprehensiveEvaluationAPI {
  '/api/evaluation/comprehensive': {
    method: 'POST',
    input: {
      transcript: string,
      audioMetrics: SpeechMetrics,
      essayContext: EssayContent,
      sessionHistory: PreviousEvaluations[]
    },
    output: {
      overallScore: number,        // 1-5ç·åˆè©•ä¾¡
      dimensionalScores: {
        linguistic: DetailedScores,    // è¨€èª5é …ç›®
        paralingual: DetailedScores,   // éè¨€èª5é …ç›®
        content: DetailedScores,       // å†…å®¹5é …ç›®
        growth: DetailedScores,        // æˆé•·5é …ç›®
        engagement: DetailedScores     // é–¢ä¸5é …ç›®
      },
      feedback: StructuredFeedback,
      recommendations: ActionableAdvice[],
      progressComparison: SessionComparison
    }
  };
}
```

### 5.3 é©å¿œå‹è³ªå•ç”ŸæˆAPI

```typescript
// ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆèªè­˜è³ªå•ç”Ÿæˆ
interface AdaptiveQuestioningAPI {
  '/api/questions/adaptive': {
    method: 'POST',
    input: {
      essayContent: EssayContent,
      conversationHistory: Message[],
      studentProfile: StudentProfile,
      targetDifficulty: DifficultyLevel,
      interviewerPersona: PersonaType,
      sessionGoals: LearningObjectives[]
    },
    output: {
      question: string,
      questionType: QuestionCategory,
      expectedDuration: number,
      difficulty: number,
      followUpSuggestions: string[],
      evaluationCriteria: AssessmentRubric
    }
  };
}
```
CREATE INDEX idx_users_target_school ON users(target_school_id);
CREATE INDEX idx_sessions_user_created ON interview_sessions(user_id, created_at);
CREATE INDEX idx_essays_user ON application_essays(user_id);
CREATE INDEX idx_questions_session ON session_questions(session_id, question_number);

-- ãƒ‡ãƒ¼ã‚¿å‰Šé™¤åŠ¹ç‡åŒ–ï¼ˆGDPRå¯¾å¿œï¼‰
CREATE INDEX idx_users_retention ON users(data_retention_until) WHERE data_retention_until < CURRENT_DATE;
```

## ğŸ”Œ APIè¨­è¨ˆ

### 1. REST API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### èªè¨¼é–¢é€£
```typescript
POST /api/auth/register
POST /api/auth/login
POST /api/auth/logout
GET  /api/auth/me
POST /api/auth/refresh
```

#### å¿—é¡˜ç†ç”±æ›¸ç®¡ç†
```typescript
GET    /api/essays                    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¿—é¡˜ç†ç”±æ›¸ä¸€è¦§
POST   /api/essays                    // æ–°è¦ä½œæˆ
GET    /api/essays/:id                // å–å¾—
PUT    /api/essays/:id                // æ›´æ–°
DELETE /api/essays/:id                // å‰Šé™¤
POST   /api/essays/:id/analyze        // AIåˆ†æå®Ÿè¡Œ
```

#### é¢æ¥ã‚»ãƒƒã‚·ãƒ§ãƒ³
```typescript
GET  /api/sessions                    // ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´
POST /api/sessions                    // æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹
GET  /api/sessions/:id                // ã‚»ãƒƒã‚·ãƒ§ãƒ³è©³ç´°
PUT  /api/sessions/:id/complete       // ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†
```

#### è³ªå•ãƒ»å›ç­”
```typescript
GET  /api/sessions/:sessionId/questions     // ã‚»ãƒƒã‚·ãƒ§ãƒ³è³ªå•ä¸€è¦§
POST /api/sessions/:sessionId/questions     // æ¬¡ã®è³ªå•ã‚’ç”Ÿæˆ
POST /api/questions/:questionId/responses   // å›ç­”ã‚’é€ä¿¡ãƒ»è©•ä¾¡
```

#### å­¦æ ¡ãƒ»æ•™è‚²ç†å¿µ
```typescript
GET /api/schools                      // å¯¾è±¡æ ¡ä¸€è¦§
GET /api/schools/:id                  // å­¦æ ¡è©³ç´°ãƒ»æ•™è‚²ç†å¿µãƒ‡ãƒ¼ã‚¿
```

### 2. ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

#### å¿—é¡˜ç†ç”±æ›¸ä½œæˆ
```typescript
// POST /api/essays
interface CreateEssayRequest {
  motivation: string;
  research_activities: string;
  school_life_goals: string;
  future_goals: string;
}

interface CreateEssayResponse {
  id: string;
  user_id: string;
  motivation: string;
  research_activities: string;
  school_life_goals: string;
  future_goals: string;
  created_at: string;
  analysis_result?: EssayAnalysis;
}

interface EssayAnalysis {
  sections: {
    motivation: SectionAnalysis;
    research_activities: SectionAnalysis;
    school_life_goals: SectionAnalysis;
    future_goals: SectionAnalysis;
  };
  overall_score: number;
  recommendations: string[];
}

interface SectionAnalysis {
  score: number; // 1-5
  keywords: string[];
  strengths: string[];
  improvements: string[];
  word_count: number;
}
```

#### é¢æ¥è³ªå•ç”Ÿæˆ
```typescript
// POST /api/sessions/:sessionId/questions
interface GenerateQuestionRequest {
  question_number: number;
  context?: {
    previous_responses?: string[];
    focus_area?: 'motivation' | 'research' | 'goals' | 'school_life';
  };
}

interface GenerateQuestionResponse {
  id: string;
  question_number: number;
  question_text: string;
  question_type: string;
  expected_duration_seconds: number;
  hints?: string[];
  
  // æ˜å’Œé«˜æ ¡ç‰¹åŒ–
  meiwa_focus?: {
    trait: string; // 'æ¢ç©¶æ´»å‹•', 'å¤¢ãƒ»æ†§ã‚Œ', etc.
    depth_level: number; // 1-3 (æµ…ã„â†’æ·±ã„)
  };
}
```

#### å›ç­”è©•ä¾¡
```typescript
// POST /api/questions/:questionId/responses
interface SubmitResponseRequest {
  response_text: string;
  response_duration_seconds: number;
  input_method: 'voice' | 'keyboard';
  
  // éŸ³å£°ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  audio_metadata?: {
    volume_level: number;
    speech_rate: number;
    pause_count: number;
  };
}

interface SubmitResponseResponse {
  id: string;
  evaluation_result: {
    score: number; // 1-5
    criteria_scores: {
      content_quality: number;
      specificity: number;
      logical_flow: number;
      school_alignment: number; // æ•™è‚²ç†å¿µé©åˆåº¦
    };
    strengths: string[];
    improvements: string[];
    next_question_suggestion?: string;
  };
  feedback_text: string;
  estimated_interview_progress: number; // 0-100%
}
```

### 3. èªè¨¼ãƒ»èªå¯è¨­è¨ˆ

#### JWTæ§‹é€ 
```typescript
interface JWTPayload {
  sub: string; // user_id
  email: string;
  student_name: string;
  target_school_id?: string;
  parent_consent: boolean;
  
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
  session_id: string;
  issued_at: number;
  expires_at: number;
  
  // æ¨©é™
  scopes: string[]; // ['student', 'parent_access']
}
```

#### ãƒ¬ãƒ¼ãƒˆåˆ¶é™
```typescript
// ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶é™ï¼ˆã‚³ã‚¹ãƒˆç®¡ç†ï¼‰
const RATE_LIMITS = {
  daily_sessions: 3,        // 1æ—¥3ã‚»ãƒƒã‚·ãƒ§ãƒ³
  monthly_sessions: 60,     // æœˆ60ã‚»ãƒƒã‚·ãƒ§ãƒ³
  ai_requests_per_hour: 20, // AI APIå‘¼ã³å‡ºã—åˆ¶é™
  
  // ä¸€èˆ¬APIåˆ¶é™
  auth_attempts: 5,         // 5å›/15åˆ†
  api_requests: 100,        // 100å›/åˆ†
};
```

## ğŸ¨ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆ

### 1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆéšå±¤

```
App
â”œâ”€â”€ AuthProvider (èªè¨¼çŠ¶æ…‹ç®¡ç†)
â”œâ”€â”€ PWAProvider (ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ã€æ›´æ–°é€šçŸ¥)
â”œâ”€â”€ Router
â”‚   â”œâ”€â”€ PublicRoutes
â”‚   â”‚   â”œâ”€â”€ LoginPage
â”‚   â”‚   â”œâ”€â”€ RegisterPage
â”‚   â”‚   â””â”€â”€ LandingPage
â”‚   â””â”€â”€ ProtectedRoutes (è¦èªè¨¼)
â”‚       â”œâ”€â”€ DashboardPage
â”‚       â”œâ”€â”€ EssayManager
â”‚       â”‚   â”œâ”€â”€ EssayEditor
â”‚       â”‚   â”œâ”€â”€ EssayAnalysis
â”‚       â”‚   â””â”€â”€ EssayPreview
â”‚       â”œâ”€â”€ InterviewSession
â”‚       â”‚   â”œâ”€â”€ SessionSetup
â”‚       â”‚   â”œâ”€â”€ QuestionDisplay
â”‚       â”‚   â”œâ”€â”€ VoiceInput
â”‚       â”‚   â”œâ”€â”€ ResponseTimer
â”‚       â”‚   â””â”€â”€ FeedbackDisplay
â”‚       â”œâ”€â”€ ProgressTracker
â”‚       â”‚   â”œâ”€â”€ SessionHistory
â”‚       â”‚   â”œâ”€â”€ ScoreCharts
â”‚       â”‚   â””â”€â”€ RecommendationList
â”‚       â””â”€â”€ Settings
â”‚           â”œâ”€â”€ ProfileSettings
â”‚           â”œâ”€â”€ SchoolSelection
â”‚           â””â”€â”€ ParentControls
```

### 2. çŠ¶æ…‹ç®¡ç†ï¼ˆZustandï¼‰

```typescript
// stores/authStore.ts
interface AuthState {
  user: User | null;
  isAuthenticated: boolean;
  login: (email: string, password: string) => Promise<void>;
  logout: () => void;
  updateProfile: (data: Partial<User>) => Promise<void>;
}

// stores/essayStore.ts
interface EssayState {
  currentEssay: ApplicationEssay | null;
  essays: ApplicationEssay[];
  isAnalyzing: boolean;
  
  createEssay: (data: CreateEssayRequest) => Promise<void>;
  updateEssay: (id: string, data: Partial<ApplicationEssay>) => Promise<void>;
  analyzeEssay: (id: string) => Promise<void>;
  loadEssays: () => Promise<void>;
}

// stores/sessionStore.ts
interface SessionState {
  currentSession: InterviewSession | null;
  currentQuestion: Question | null;
  questions: Question[];
  responses: QuestionResponse[];
  isRecording: boolean;
  
  startSession: (essayId: string, schoolId: string) => Promise<void>;
  generateNextQuestion: () => Promise<void>;
  submitResponse: (response: SubmitResponseRequest) => Promise<void>;
  completeSession: () => Promise<void>;
}
```

### 3. PWAè¨­å®šï¼ˆmanifest.jsonï¼‰

```json
{
  "name": "é¢æ¥ç·´ç¿’ã‚¢ãƒ—ãƒª - æ˜å’Œé«˜æ ¡é™„å±ä¸­å¯¾å¿œ",
  "short_name": "é¢æ¥ç·´ç¿’",
  "description": "æ„›çŸ¥çœŒå…¬ç«‹ä¸­é«˜ä¸€è²«æ ¡ã®é¢æ¥ç·´ç¿’ã‚¢ãƒ—ãƒª",
  "start_url": "/",
  "display": "standalone",
  "orientation": "portrait-primary",
  "theme_color": "#3B82F6",
  "background_color": "#FFFFFF",
  
  "icons": [
    {
      "src": "/icons/icon-192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-512.png", 
      "sizes": "512x512",
      "type": "image/png"
    }
  ],
  
  "categories": ["education", "productivity"],
  "lang": "ja",
  
  "shortcuts": [
    {
      "name": "æ–°ã—ã„é¢æ¥ç·´ç¿’",
      "short_name": "é¢æ¥é–‹å§‹",
      "description": "é¢æ¥ç·´ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹",
      "url": "/interview/new",
      "icons": [{"src": "/icons/interview-shortcut.png", "sizes": "96x96"}]
    }
  ]
}
```

### 4. Service Workerè¨­è¨ˆ

```typescript
// service-worker.ts (Workbox)
import { precacheAndRoute, cleanupOutdatedCaches } from 'workbox-precaching';
import { registerRoute } from 'workbox-routing';
import { StaleWhileRevalidate, CacheFirst, NetworkFirst } from 'workbox-strategies';

// é™çš„ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ—ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥
precacheAndRoute(self.__WB_MANIFEST);
cleanupOutdatedCaches();

// API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
registerRoute(
  ({ url }) => url.pathname.startsWith('/api/schools'),
  new CacheFirst({
    cacheName: 'schools-cache',
    plugins: [{
      cacheKeyWillBeUsed: async ({ request }) => {
        return `schools-${new URL(request.url).pathname}`;
      }
    }]
  })
);

// éŸ³å£°èªè­˜ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ
registerRoute(
  ({ url }) => url.pathname.includes('/speech-recognition'),
  new NetworkFirst({
    cacheName: 'speech-api-cache',
    networkTimeoutSeconds: 3
  })
);

// AIç”Ÿæˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®é©åº¦ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥
registerRoute(
  ({ url }) => url.pathname.startsWith('/api/questions'),
  new StaleWhileRevalidate({
    cacheName: 'questions-cache',
    plugins: [{
      cacheWillUpdate: async ({ response }) => {
        return response.status === 200;
      }
    }]
  })
);
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### 1. èªè¨¼ãƒ»èªå¯ãƒ•ãƒ­ãƒ¼

```typescript
// JWTèªè¨¼ãƒ•ãƒ­ãƒ¼
class AuthService {
  async login(email: string, password: string): Promise<AuthResult> {
    // 1. å…¥åŠ›æ¤œè¨¼
    const validation = await this.validateCredentials(email, password);
    if (!validation.isValid) {
      throw new AuthError('INVALID_CREDENTIALS');
    }
    
    // 2. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒã‚§ãƒƒã‚¯
    await this.checkRateLimit(email);
    
    // 3. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼ï¼ˆbcryptï¼‰
    const user = await this.getUserByEmail(email);
    const isValidPassword = await bcrypt.compare(password, user.password_hash);
    
    if (!isValidPassword) {
      await this.recordFailedAttempt(email);
      throw new AuthError('INVALID_CREDENTIALS');
    }
    
    // 4. JWTç”Ÿæˆ
    const tokens = await this.generateTokens(user);
    
    // 5. ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨˜éŒ²
    await this.createSession(user.id, tokens.session_id);
    
    return { user, tokens };
  }
  
  async validateJWT(token: string): Promise<JWTPayload> {
    try {
      const payload = jwt.verify(token, JWT_SECRET) as JWTPayload;
      
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ‰åŠ¹æ€§ç¢ºèª
      const session = await this.getSession(payload.session_id);
      if (!session || session.revoked) {
        throw new AuthError('SESSION_REVOKED');
      }
      
      return payload;
    } catch (error) {
      throw new AuthError('INVALID_TOKEN');
    }
  }
}
```

### 2. ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–

```typescript
// å€‹äººæƒ…å ±æš—å·åŒ–ï¼ˆAES-256-GCMï¼‰
class EncryptionService {
  private readonly algorithm = 'aes-256-gcm';
  private readonly keyLength = 32;
  
  async encryptPersonalData(data: string): Promise<EncryptedData> {
    const key = await this.getOrCreateDataKey();
    const iv = crypto.randomBytes(16);
    
    const cipher = crypto.createCipher(this.algorithm, key);
    cipher.setAAD(Buffer.from('personal-data'));
    
    let encrypted = cipher.update(data, 'utf8', 'base64');
    encrypted += cipher.final('base64');
    
    const authTag = cipher.getAuthTag();
    
    return {
      encrypted_data: encrypted,
      iv: iv.toString('base64'),
      auth_tag: authTag.toString('base64'),
      key_version: await this.getCurrentKeyVersion()
    };
  }
  
  async decryptPersonalData(encryptedData: EncryptedData): Promise<string> {
    const key = await this.getDataKey(encryptedData.key_version);
    const iv = Buffer.from(encryptedData.iv, 'base64');
    const authTag = Buffer.from(encryptedData.auth_tag, 'base64');
    
    const decipher = crypto.createDecipher(this.algorithm, key);
    decipher.setAAD(Buffer.from('personal-data'));
    decipher.setAuthTag(authTag);
    
    let decrypted = decipher.update(encryptedData.encrypted_data, 'base64', 'utf8');
    decrypted += decipher.final('utf8');
    
    return decrypted;
  }
}
```

### 3. å…¥åŠ›æ¤œè¨¼ãƒ»ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

```typescript
// Zod ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
const CreateEssaySchema = z.object({
  motivation: z.string()
    .min(50, 'å¿—æœ›å‹•æ©Ÿã¯50æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„')
    .max(500, 'å¿—æœ›å‹•æ©Ÿã¯500æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„')
    .refine(data => !containsProhibitedContent(data), 'ä¸é©åˆ‡ãªå†…å®¹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™'),
    
  research_activities: z.string()
    .min(100, 'æ¢ç©¶æ´»å‹•ã¯100æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„')
    .max(800, 'æ¢ç©¶æ´»å‹•ã¯800æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„'),
    
  school_life_goals: z.string()
    .min(50, 'å­¦æ ¡ç”Ÿæ´»ã®æŠ±è² ã¯50æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„')
    .max(400, 'å­¦æ ¡ç”Ÿæ´»ã®æŠ±è² ã¯400æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„'),
    
  future_goals: z.string()
    .min(50, 'å°†æ¥ã®ç›®æ¨™ã¯50æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„')
    .max(400, 'å°†æ¥ã®ç›®æ¨™ã¯400æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„')
});

// XSSå¯¾ç­–
function sanitizeUserInput(input: string): string {
  return DOMPurify.sanitize(input, {
    ALLOWED_TAGS: [], // HTMLã‚¿ã‚°ã‚’å…¨ã¦é™¤å»
    ALLOWED_ATTR: []
  });
}

// ç¦æ­¢ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒã‚§ãƒƒã‚¯
function containsProhibitedContent(text: string): boolean {
  const prohibitedPatterns = [
    /å€‹äººæƒ…å ±|ä½æ‰€|é›»è©±ç•ªå·/i,
    /èª¹è¬—ä¸­å‚·|å·®åˆ¥/i,
    /ä¸é©åˆ‡|æš´åŠ›/i
  ];
  
  return prohibitedPatterns.some(pattern => pattern.test(text));
}
```

### 4. GDPRãƒ»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼å¯¾å¿œ

```typescript
// ãƒ‡ãƒ¼ã‚¿ä¿æŒãƒ»å‰Šé™¤ç®¡ç†
class PrivacyManager {
  async scheduleDataDeletion(userId: string): Promise<void> {
    const retentionPeriod = 365; // 1å¹´é–“
    const deletionDate = new Date();
    deletionDate.setDate(deletionDate.getDate() + retentionPeriod);
    
    await db.user.update({
      where: { id: userId },
      data: { data_retention_until: deletionDate }
    });
    
    // å‰Šé™¤ã‚¸ãƒ§ãƒ–ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
    await this.scheduleCleanupJob(userId, deletionDate);
  }
  
  async deleteUserData(userId: string): Promise<void> {
    await db.$transaction(async (tx) => {
      // é–¢é€£ãƒ‡ãƒ¼ã‚¿ã‚’é †æ¬¡å‰Šé™¤
      await tx.questionResponse.deleteMany({ where: { question: { session: { userId } } } });
      await tx.sessionQuestion.deleteMany({ where: { session: { userId } } });
      await tx.interviewSession.deleteMany({ where: { userId } });
      await tx.applicationEssay.deleteMany({ where: { userId } });
      await tx.user.delete({ where: { id: userId } });
    });
    
    // ãƒ­ã‚°ã«è¨˜éŒ²ï¼ˆç›£æŸ»ç”¨ï¼‰
    await this.logDataDeletion(userId, 'GDPR_COMPLIANCE');
  }
  
  async exportUserData(userId: string): Promise<UserDataExport> {
    const user = await db.user.findUnique({
      where: { id: userId },
      include: {
        essays: true,
        sessions: {
          include: {
            questions: {
              include: {
                responses: true
              }
            }
          }
        }
      }
    });
    
    if (!user) throw new Error('User not found');
    
    // å€‹äººãƒ‡ãƒ¼ã‚¿ã‚’å¾©å·åŒ–ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    const decryptedData = await this.decryptUserData(user);
    
    return {
      personal_info: {
        name: decryptedData.student_name,
        email: decryptedData.email,
        created_at: user.created_at
      },
      essays: decryptedData.essays,
      interview_history: decryptedData.sessions,
      data_processing_log: await this.getProcessingLog(userId)
    };
  }
}
```

## ğŸ¤– AIçµ±åˆè¨­è¨ˆ

### 1. OpenAI APIçµ±åˆ

```typescript
// AI APIç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹
class OpenAIService {
  private readonly client: OpenAI;
  private readonly costTracker: CostTracker;
  
  constructor() {
    this.client = new OpenAI({
      apiKey: process.env.OPENAI_API_KEY,
      timeout: 10000 // 10ç§’ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
    });
    this.costTracker = new CostTracker();
  }
  
  async generateInterviewQuestion(
    essay: ApplicationEssay,
    school: School,
    context: QuestionContext
  ): Promise<GeneratedQuestion> {
    const prompt = this.buildQuestionPrompt(essay, school, context);
    
    // ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å“è³ªï¼šè¤‡æ•°AIãƒ¢ãƒ‡ãƒ«ã§ã®è³ªå•ç”Ÿæˆã¨é¸æŠ
    const [gpt4Response, claudeResponse] = await Promise.allSettled([
      this.generateWithGPT4(prompt, school),
      this.generateWithClaude(prompt, school)
    ]);
    
    // æœ€é©ãªè³ªå•ã‚’é¸æŠï¼ˆå“è³ªè©•ä¾¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰
    const bestQuestion = await this.selectBestQuestion([
      gpt4Response.status === 'fulfilled' ? gpt4Response.value : null,
      claudeResponse.status === 'fulfilled' ? claudeResponse.value : null
    ].filter(Boolean));
    
    // è³ªå•ã®å“è³ªå‘ä¸Šå‡¦ç†
    const enhancedQuestion = await this.enhanceQuestionQuality(bestQuestion, school);
    
    return enhancedQuestion;
  }
  
  private async generateWithGPT4(prompt: string, school: School): Promise<GeneratedQuestion> {
    const response = await this.client.chat.completions.create({
      model: 'gpt-4-turbo-preview', // æœ€æ–°ãƒ¢ãƒ‡ãƒ«ä½¿ç”¨
      messages: [
        {
          role: 'system',
          content: await this.getAdvancedSystemPrompt(school)
        },
        {
          role: 'user',
          content: prompt
        }
      ],
      max_tokens: 300, // ã‚ˆã‚Šè©³ç´°ãªè³ªå•ç”Ÿæˆ
      temperature: 0.8,
      top_p: 0.95,
      frequency_penalty: 0.3, // å¤šæ§˜æ€§å‘ä¸Š
      presence_penalty: 0.3
    });
    
    return this.parseQuestionResponse(response, 'gpt-4');
  }
  
  private async generateWithClaude(prompt: string, school: School): Promise<GeneratedQuestion> {
    // Claude 3.5 Sonnet APIã¨ã®çµ±åˆ
    const response = await this.claudeClient.messages.create({
      model: 'claude-3-5-sonnet-20241022',
      max_tokens: 300,
      messages: [
        {
          role: 'user',
          content: `${await this.getAdvancedSystemPrompt(school)}\n\n${prompt}`
        }
      ]
    });
    
    return this.parseClaudeResponse(response);
  }
  
  async evaluateResponse(
    question: string,
    response: string,
    school: School,
    audioMetadata?: AudioMetadata
  ): Promise<EnhancedResponseEvaluation> {
    // ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«è©•ä¾¡ï¼šãƒ†ã‚­ã‚¹ãƒˆ + éŸ³å£°æƒ…å ±
    const [textEvaluation, voiceEvaluation] = await Promise.all([
      this.evaluateTextContent(question, response, school),
      audioMetadata ? this.evaluateVoiceQuality(audioMetadata) : null
    ]);
    
    // åŒ…æ‹¬çš„è©•ä¾¡ã®çµ±åˆ
    return this.combineEvaluations(textEvaluation, voiceEvaluation, school);
  }
  
  async evaluateResponse(
    question: string,
    response: string,
    school: School
  ): Promise<ResponseEvaluation> {
    // è©•ä¾¡ã¯GPT-4ã‚’ä½¿ç”¨ï¼ˆå“è³ªé‡è¦–ï¼‰
    const evaluationPrompt = this.buildEvaluationPrompt(question, response, school);
    
    const completion = await this.client.chat.completions.create({
      model: 'gpt-4',
      messages: [
        {
          role: 'system',
          content: await this.getEvaluationSystemPrompt(school)
        },
        {
          role: 'user',
          content: evaluationPrompt
        }
      ],
      max_tokens: 300,
      temperature: 0.3 // è©•ä¾¡ã¯ä¸€è²«æ€§é‡è¦–
    });
    
    const evaluation = completion.choices[0]?.message?.content;
    
    // æ§‹é€ åŒ–ã•ã‚ŒãŸè©•ä¾¡çµæœã«ãƒ‘ãƒ¼ã‚¹
    return this.parseEvaluationResult(evaluation, school);
  }
  
  private async getSystemPrompt(school: School): Promise<string> {
    const schoolData = school.interview_patterns as any;
    
    return `ã‚ãªãŸã¯${school.name}ã®é¢æ¥å®˜ã§ã™ã€‚

å­¦æ ¡ã®æ•™è‚²ç†å¿µ: ${school.mission}

é¢æ¥ã®ç‰¹å¾´:
- æ¢ç©¶æ´»å‹•é‡è¦–åº¦: ${schoolData.meiwa_typical?.question_ratio?.['æ¢ç©¶æ´»å‹•æ·±å €ã‚Š'] * 100}%
- è³ªå•ã®æ·±åº¦: å°å­¦6å¹´ç”Ÿã«é©ã—ãŸãƒ¬ãƒ™ãƒ«
- è©•ä¾¡è¦³ç‚¹: å…·ä½“æ€§ã€æ¢ç©¶å¿ƒã€å­¦æ ¡ã¸ã®ç†è§£

å°å­¦6å¹´ç”Ÿã«é©ã—ãŸé¢æ¥è³ªå•ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
- åˆ†ã‹ã‚Šã‚„ã™ã„è¨€è‘‰ã§è³ªå•ã™ã‚‹
- å…·ä½“çš„ãªä½“é¨“è«‡ã‚’å¼•ãå‡ºã™
- ç­”ãˆã‚„ã™ã„å½¢ã§è³ªå•ã™ã‚‹`;
  }
}
```

### 2. ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å“è³ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

```typescript
class QualityManager {
  private readonly MONTHLY_BUDGET = 50000; // 5ä¸‡å††ï¼ˆå“è³ªé‡è¦–äºˆç®—ï¼‰
  private readonly PERFORMANCE_THRESHOLD = {
    response_time_ms: 2000,      // 2ç§’ä»¥å†…ã®å¿œç­”
    accuracy_score: 0.95,        // 95%ä»¥ä¸Šã®ç²¾åº¦
    user_satisfaction: 4.5       // 5æ®µéšè©•ä¾¡ã§4.5ä»¥ä¸Š
  };
  
  async ensureQualityStandards(): Promise<void> {
    const metrics = await this.getCurrentMetrics();
    
    // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŸºæº–ã‚’ä¸‹å›ã‚‹å ´åˆã¯é«˜æ€§èƒ½ãƒ¢ãƒ‡ãƒ«ã«åˆ‡ã‚Šæ›¿ãˆ
    if (metrics.response_time > this.PERFORMANCE_THRESHOLD.response_time_ms) {
      await this.switchToHighPerformanceMode();
    }
    
    // ç²¾åº¦ãŒåŸºæº–ã‚’ä¸‹å›ã‚‹å ´åˆã¯è¿½åŠ æ¤œè¨¼ã‚’å®Ÿæ–½
    if (metrics.accuracy < this.PERFORMANCE_THRESHOLD.accuracy_score) {
      await this.enableEnhancedValidation();
    }
  }
  
  async recordUsage(usage: APIUsage): Promise<void> {
    const cost = this.calculateCost(usage);
    
    await db.aiUsage.create({
      data: {
        date: new Date(),
        model: usage.model,
        tokens: usage.tokens,
        cost_yen: cost,
        operation_type: usage.operation_type
      }
    });
    
    // ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèª
    await this.checkCostAlerts();
  }
  
  private calculateCost(usage: APIUsage): number {
    const rates = {
      'gpt-3.5-turbo': 0.002 / 1000, // $0.002 per 1K tokens
      'gpt-4': 0.03 / 1000           // $0.03 per 1K tokens
    };
    
    const usdCost = usage.tokens * rates[usage.model];
    return usdCost * 150; // USD to JPY conversion (æ¦‚ç®—)
  }
  
  async getUsageAnalytics(): Promise<UsageAnalytics> {
    const thisMonth = await this.getMonthlyUsage();
    const lastMonth = await this.getMonthlyUsage(-1);
    
    return {
      current_month: {
        total_cost: thisMonth.total_cost,
        requests_count: thisMonth.requests_count,
        budget_utilization: thisMonth.total_cost / this.MONTHLY_BUDGET
      },
      projection: {
        end_of_month_cost: this.projectEndOfMonthCost(thisMonth),
        days_until_limit: this.calculateDaysUntilLimit(thisMonth)
      },
      optimization_suggestions: this.generateOptimizationSuggestions(thisMonth)
    };
  }
}
```

### 3. æ•™è‚²ç†å¿µã‚¨ãƒ³ã‚¸ãƒ³

```typescript
class EducationalPhilosophyEngine {
  private schoolData: Map<string, SchoolProfile> = new Map();
  
  async initializeSchoolData(): Promise<void> {
    const schools = await db.school.findMany();
    
    for (const school of schools) {
      this.schoolData.set(school.code, {
        ...school,
        essay_structure: school.essay_structure as EssayStructure,
        interview_patterns: school.interview_patterns as InterviewPatterns
      });
    }
  }
  
  analyzeEssayAlignment(
    essay: ApplicationEssay, 
    schoolCode: string
  ): EssayAlignment {
    const school = this.schoolData.get(schoolCode);
    if (!school) throw new Error('School not found');
    
    const analysis: EssayAlignment = {
      overall_score: 0,
      section_scores: {},
      recommendations: []
    };
    
    // å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å­¦æ ¡ã®é‡è¦–åº¦ã«åŸºã¥ã„ã¦è©•ä¾¡
    for (const section of school.essay_structure.sections) {
      const sectionText = essay[section.field_name as keyof ApplicationEssay] as string;
      const score = this.evaluateSection(sectionText, section);
      
      analysis.section_scores[section.name] = {
        score,
        weight: section.weight,
        weighted_score: score * section.weight
      };
      
      analysis.overall_score += score * section.weight;
    }
    
    // æ˜å’Œé«˜æ ¡ç‰¹åŒ–ã®æ¨å¥¨äº‹é …
    if (schoolCode === 'meiwa') {
      analysis.recommendations = this.generateMeiwaRecommendations(essay, analysis);
    }
    
    return analysis;
  }
  
  private generateMeiwaRecommendations(
    essay: ApplicationEssay,
    analysis: EssayAlignment
  ): string[] {
    const recommendations: string[] = [];
    
    // æ¢ç©¶æ´»å‹•ã®è©³ç´°åº¦ãƒã‚§ãƒƒã‚¯
    const researchScore = analysis.section_scores['æ¢ç©¶æ´»å‹•ã®å®Ÿç¸¾ãƒ»çµŒé¨“']?.score || 0;
    if (researchScore < 3.5) {
      recommendations.push(
        'æ¢ç©¶æ´»å‹•ã®å†…å®¹ã‚’ã‚‚ã†å°‘ã—è©³ã—ãæ›¸ãã¾ã—ã‚‡ã†ã€‚ã©ã‚“ãªç–‘å•ã‹ã‚‰å§‹ã¾ã£ãŸã‹ã€ã©ã†ã‚„ã£ã¦èª¿ã¹ãŸã‹ã€ä½•ã‚’ç™ºè¦‹ã—ãŸã‹ã‚’å…·ä½“çš„ã«æ›¸ãã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚'
      );
    }
    
    // å¤¢ãƒ»å°†æ¥ç›®æ¨™ã®å…·ä½“æ€§ãƒã‚§ãƒƒã‚¯
    const futureGoalsScore = analysis.section_scores['å°†æ¥ã®ç›®æ¨™']?.score || 0;
    if (futureGoalsScore < 3.0) {
      recommendations.push(
        'å°†æ¥ã®ç›®æ¨™ã‚’ã‚‚ã£ã¨å…·ä½“çš„ã«æ›¸ãã¾ã—ã‚‡ã†ã€‚ã€Œã€‡ã€‡ã«ãªã‚ŠãŸã„ã€ã ã‘ã§ãªãã€ã€Œãªãœãã®ä»•äº‹ã«èˆˆå‘³ã‚’æŒã£ãŸã®ã‹ã€ã€Œãã®ãŸã‚ã«ä½•ã‚’ãŒã‚“ã°ã‚ŠãŸã„ã‹ã€ã‚‚æ›¸ã‘ã‚‹ã¨è‰¯ã„ã§ã™ã­ã€‚'
      );
    }
    
    // æ¢ç©¶æ´»å‹•ã¨å°†æ¥ç›®æ¨™ã®é–¢é€£æ€§ãƒã‚§ãƒƒã‚¯
    const connectionScore = this.analyzeResearchGoalConnection(essay);
    if (connectionScore < 2.5) {
      recommendations.push(
        'æ¢ç©¶æ´»å‹•ã¨å°†æ¥ã®ç›®æ¨™ã®ã¤ãªãŒã‚Šã‚’æ›¸ã‘ã‚‹ã¨ã€ã‚ãªãŸã®è€ƒãˆãŒã‚ˆãä¼ã‚ã‚Šã¾ã™ã€‚èª¿ã¹ãŸã“ã¨ãŒå°†æ¥ã®å¤¢ã«ã©ã†é–¢ä¿‚ã—ã¦ã„ã‚‹ã‹è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚'
      );
    }
    
    return recommendations;
  }
  
  generateSchoolSpecificQuestions(
    essay: ApplicationEssay,
    schoolCode: string,
    questionNumber: number
  ): SchoolSpecificQuestion {
    const school = this.schoolData.get(schoolCode);
    if (!school) throw new Error('School not found');
    
    const patterns = school.interview_patterns as any;
    
    if (schoolCode === 'meiwa') {
      return this.generateMeiwaQuestion(essay, patterns, questionNumber);
    }
    
    // ä»–æ ¡ç”¨ã®æ¨™æº–è³ªå•ç”Ÿæˆ
    return this.generateStandardQuestion(essay, school, questionNumber);
  }
  
  private generateMeiwaQuestion(
    essay: ApplicationEssay,
    patterns: any,
    questionNumber: number
  ): SchoolSpecificQuestion {
    const questionRatio = patterns.meiwa_typical.question_ratio;
    
    // æ˜å’Œã®è³ªå•é…åˆ†ã«åŸºã¥ãè³ªå•é¸æŠ
    if (questionNumber <= 3) {
      // æœ€åˆã®3å•ã¯æ¢ç©¶æ´»å‹•é‡è¦–ï¼ˆ60%é…åˆ†ï¼‰
      const researchActivity = this.extractMainResearchActivity(essay.research_activities);
      
      const questions = [
        `å¿—é¡˜ç†ç”±æ›¸ã«æ›¸ã„ãŸã€Œ${researchActivity.topic}ã€ã«ã¤ã„ã¦ã€ã‚‚ã†å°‘ã—è©³ã—ãæ•™ãˆã¦ãã ã•ã„ã€‚`,
        `ã€Œ${researchActivity.topic}ã€ã‚’èª¿ã¹ã¦ã„ã¦ã€ä¸€ç•ªå°è±¡ã«æ®‹ã£ãŸã“ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ`,
        `èª¿ã¹ã¦ã„ã¦ç–‘å•ã«æ€ã£ãŸã“ã¨ã€ã‚‚ã£ã¨çŸ¥ã‚ŠãŸããªã£ãŸã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ`
      ];
      
      return {
        text: questions[questionNumber - 1],
        type: 'research_deep_dive',
        focus_area: 'research_activities',
        expected_duration_seconds: 120,
        meiwa_specific: {
          trait_alignment: 'çŸ¥çš„å¥½å¥‡å¿ƒãƒ»ä¸»ä½“æ€§',
          depth_level: questionNumber
        }
      };
    } else {
      // 4-5é—®ç›®ã¯ä»–ã®è¦ç´ 
      const standardQuestions = [
        `ãªãœæ˜å’Œé«˜æ ¡é™„å±ä¸­å­¦æ ¡ã§å­¦ã³ãŸã„ã¨æ€ã£ãŸã®ã§ã™ã‹ï¼Ÿ`,
        `ãã®æ¢ç©¶æ´»å‹•ã¯ã€å°†æ¥ã®ç›®æ¨™ã¨ã©ã†ã¤ãªãŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ`
      ];
      
      return {
        text: standardQuestions[questionNumber - 4],
        type: questionNumber === 4 ? 'motivation' : 'goal_connection',
        focus_area: questionNumber === 4 ? 'motivation' : 'future_goals',
        expected_duration_seconds: 90
      };
    }
  }
}
```

## ğŸŒŸ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å“è³ªæ©Ÿèƒ½

### 1. é«˜ç²¾åº¦éŸ³å£°å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ 

```typescript
class PremiumVoiceService {
  private googleSpeech: speech.SpeechClient;
  private azureSpeech: CognitiveServices.SpeechService;
  private elevenLabs: ElevenLabsClient;
  
  constructor() {
    this.googleSpeech = new speech.SpeechClient();
    this.azureSpeech = new CognitiveServices.SpeechService();
    this.elevenLabs = new ElevenLabsClient();
  }
  
  async transcribeWithHighAccuracy(audioBuffer: Buffer): Promise<TranscriptionResult> {
    // è¤‡æ•°ã®éŸ³å£°èªè­˜ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä¸¦åˆ—å®Ÿè¡Œ
    const [googleResult, azureResult, browserResult] = await Promise.allSettled([
      this.transcribeWithGoogle(audioBuffer),
      this.transcribeWithAzure(audioBuffer),
      this.transcribeWithBrowser(audioBuffer) // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
    ]);
    
    // çµæœã‚’çµ±åˆã—ã¦æœ€é«˜ç²¾åº¦ã®è»¢å†™ã‚’ç”Ÿæˆ
    return this.mergeLabelResults([
      googleResult.status === 'fulfilled' ? googleResult.value : null,
      azureResult.status === 'fulfilled' ? azureResult.value : null,
      browserResult.status === 'fulfilled' ? browserResult.value : null
    ].filter(Boolean));
  }
  
  async generateNaturalVoice(text: string): Promise<AudioBuffer> {
    // ElevenLabsã«ã‚ˆã‚‹è‡ªç„¶ãªæ—¥æœ¬èªéŸ³å£°åˆæˆ
    const voiceResponse = await this.elevenLabs.textToSpeech({
      text,
      voice_id: 'japanese_female_teacher', // é¢æ¥å®˜ã‚‰ã—ã„å£°
      model_id: 'eleven_multilingual_v2',
      voice_settings: {
        stability: 0.8,
        similarity_boost: 0.9,
        speaking_rate: 0.9 // å°å­¦ç”Ÿã«ã¨ã£ã¦èãå–ã‚Šã‚„ã™ã„é€Ÿåº¦
      }
    });
    
    return voiceResponse.audio;
  }
  
  async analyzeVoiceQuality(audioMetadata: AudioMetadata): Promise<VoiceAnalysis> {
    return {
      clarity_score: this.calculateClarity(audioMetadata),
      pace_analysis: this.analyzeSpeechPace(audioMetadata),
      volume_consistency: this.analyzeVolumeConsistency(audioMetadata),
      pause_patterns: this.analyzePausePatterns(audioMetadata),
      confidence_indicators: this.detectConfidenceMarkers(audioMetadata),
      improvement_suggestions: this.generateVoiceImprovements(audioMetadata)
    };
  }
}
```

### 2. ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«AIè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 

```typescript
class AdvancedEvaluationEngine {
  private gptModels: string[] = ['gpt-4-turbo', 'gpt-4', 'gpt-3.5-turbo'];
  private claudeModels: string[] = ['claude-3-5-sonnet', 'claude-3-opus'];
  
  async performComprehensiveEvaluation(
    question: string,
    textResponse: string,
    audioAnalysis: VoiceAnalysis,
    school: School
  ): Promise<ComprehensiveEvaluation> {
    
    // è¤‡æ•°AIãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹å¤šè§’çš„è©•ä¾¡
    const evaluations = await Promise.all([
      this.evaluateWithGPT4Advanced(question, textResponse, school),
      this.evaluateWithClaude(question, textResponse, school),
      this.evaluateVoiceCharacteristics(audioAnalysis),
      this.evaluateSchoolAlignment(textResponse, school),
      this.evaluateAgeAppropriateness(textResponse, 12) // å°å­¦6å¹´ç”Ÿ
    ]);
    
    // è©•ä¾¡çµæœã®çµ±åˆã¨é‡ã¿ä»˜ã‘
    const consolidatedEvaluation = this.consolidateEvaluations(evaluations);
    
    // å€‹åˆ¥åŒ–ã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”Ÿæˆ
    const personalizedFeedback = await this.generatePersonalizedFeedback(
      consolidatedEvaluation, 
      school
    );
    
    return {
      overall_score: consolidatedEvaluation.weighted_average,
      dimension_scores: consolidatedEvaluation.dimension_breakdown,
      voice_analysis: audioAnalysis,
      feedback: personalizedFeedback,
      next_steps: await this.generateNextSteps(consolidatedEvaluation),
      confidence_interval: consolidatedEvaluation.confidence_range
    };
  }
  
  private async generatePersonalizedFeedback(
    evaluation: ConsolidatedEvaluation,
    school: School
  ): Promise<PersonalizedFeedback> {
    // å°å­¦ç”Ÿå‘ã‘ã®å„ªã—ã„è¡¨ç¾ã§ã€å…·ä½“çš„ã§å®Ÿè¡Œå¯èƒ½ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹
    const feedbackPrompt = `
å°å­¦6å¹´ç”Ÿã®${school.name}å—é¨“ç”Ÿã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®è©•ä¾¡çµæœã‚’åŸºã«
åŠ±ã¾ã—ã¨å…·ä½“çš„ãªæ”¹å–„ææ¡ˆã‚’å«ã‚€å„ªã—ã„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ï¼š

è©•ä¾¡çµæœ: ${JSON.stringify(evaluation)}
å­¦æ ¡ã®æ•™è‚²ç†å¿µ: ${school.mission}

ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®è¦ä»¶:
1. å°å­¦ç”Ÿã«ã‚‚åˆ†ã‹ã‚Šã‚„ã™ã„è¨€è‘‰ã‚’ä½¿ç”¨
2. ã¾ãšè‰¯ã„ç‚¹ã‚’è¤’ã‚ã‚‹
3. æ”¹å–„ç‚¹ã¯å…·ä½“çš„ã§å®Ÿè¡Œã—ã‚„ã™ã„ææ¡ˆ
4. åŠ±ã¾ã—ã®è¨€è‘‰ã§çµ‚ãˆã‚‹
5. æ¬¡å›ã®ç·´ç¿’ã¸ã®æ„æ¬²ã‚’é«˜ã‚ã‚‹å†…å®¹
    `;
    
    const feedback = await this.generateWithMultipleAI(feedbackPrompt);
    
    return {
      positive_aspects: feedback.strengths,
      improvement_areas: feedback.areas_to_work_on,
      specific_actions: feedback.actionable_steps,
      encouragement: feedback.motivational_message,
      practice_suggestions: feedback.next_practice_focus
    };
  }
}
```

### 3. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é©å¿œå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 

```typescript
class AdaptiveLearningEngine {
  async adjustDifficultyInRealTime(
    studentProfile: StudentProfile,
    currentPerformance: PerformanceMetrics,
    sessionProgress: SessionProgress
  ): Promise<AdaptationStrategy> {
    
    // å­¦ç¿’è€…ã®ç†è§£åº¦ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æ
    const comprehensionLevel = await this.analyzeComprehension(
      studentProfile.past_sessions,
      currentPerformance
    );
    
    // æœ€é©ãªé›£æ˜“åº¦èª¿æ•´ã‚’æ±ºå®š
    if (comprehensionLevel.confidence_score > 0.8) {
      // ç†è§£åº¦ãŒé«˜ã„å ´åˆã¯ã‚ˆã‚Šæ·±ã„è³ªå•ã¸
      return {
        next_question_complexity: 'advanced',
        follow_up_depth: 'deep_dive',
        support_level: 'minimal',
        time_pressure: 'standard'
      };
    } else if (comprehensionLevel.confidence_score < 0.4) {
      // ç†è§£åº¦ãŒä½ã„å ´åˆã¯ã‚µãƒãƒ¼ãƒˆã‚’å¼·åŒ–
      return {
        next_question_complexity: 'basic',
        follow_up_depth: 'surface',
        support_level: 'enhanced',
        time_pressure: 'relaxed',
        hint_availability: true
      };
    }
    
    return this.generateBalancedStrategy(comprehensionLevel);
  }
  
  async providelntelligentHints(
    question: string,
    studentResponse: string,
    strugglingArea: string
  ): Promise<IntelligentHint> {
    const hintPrompt = `
å°å­¦6å¹´ç”ŸãŒä»¥ä¸‹ã®é¢æ¥è³ªå•ã§å›°ã£ã¦ã„ã¾ã™ï¼š
è³ªå•: ${question}
ç¾åœ¨ã®å›ç­”: ${studentResponse}
å›°ã£ã¦ã„ã‚‹åˆ†é‡: ${strugglingArea}

ã“ã®ç”Ÿå¾’ãŒè‡ªåˆ†ã§ç­”ãˆã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ãªã€
é©åˆ‡ãªãƒ’ãƒ³ãƒˆã‚’æ®µéšçš„ã«æä¾›ã—ã¦ãã ã•ã„ã€‚
ç­”ãˆã‚’ç›´æ¥æ•™ãˆã‚‹ã®ã§ã¯ãªãã€è€ƒãˆã‚‹æ–¹å‘æ€§ã‚’ç¤ºã™ã‚ˆã†ãªãƒ’ãƒ³ãƒˆã«ã—ã¦ãã ã•ã„ã€‚
    `;
    
    const hints = await this.generateProgressiveHints(hintPrompt);
    
    return {
      level_1_hint: hints.gentle_nudge,      // è»½ã„ãƒ’ãƒ³ãƒˆ
      level_2_hint: hints.directional_help,  // æ–¹å‘æ€§ã®æŒ‡ç¤º
      level_3_hint: hints.structured_support, // æ§‹é€ åŒ–ã•ã‚ŒãŸã‚µãƒãƒ¼ãƒˆ
      example_framework: hints.thinking_framework // è€ƒãˆæ–¹ã®æ çµ„ã¿
    };
  }
}
```

### 4. é«˜åº¦ãªé€²æ—åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆ

```typescript
class PremiumAnalyticsEngine {
  async generateComprehensiveReport(
    studentId: string,
    timeframe: 'weekly' | 'monthly' | 'cumulative'
  ): Promise<ComprehensiveReport> {
    
    const analyticsData = await this.gatherAnalyticsData(studentId, timeframe);
    
    return {
      executive_summary: await this.generateExecutiveSummary(analyticsData),
      skill_progression: await this.analyzeSkillProgression(analyticsData),
      strength_analysis: await this.identifyStrengths(analyticsData),
      improvement_opportunities: await this.identifyGrowthAreas(analyticsData),
      comparative_analysis: await this.generatePeerComparison(analyticsData),
      predictive_insights: await this.generatePredictions(analyticsData),
      personalized_curriculum: await this.recommendCurriculum(analyticsData),
      parental_guidance: await this.generateParentGuidance(analyticsData)
    };
  }
  
  async detectLearningPatterns(studentSessions: InterviewSession[]): Promise<LearningPatterns> {
    // æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹å­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
    const patterns = await this.mlAnalyzer.detectPatterns(studentSessions);
    
    return {
      peak_performance_times: patterns.optimal_practice_times,
      effective_question_types: patterns.high_performance_categories,
      learning_velocity: patterns.improvement_rate,
      retention_patterns: patterns.knowledge_retention,
      motivation_triggers: patterns.engagement_drivers,
      fatigue_indicators: patterns.performance_decline_signals
    };
  }
}
```

## ğŸ¨ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ UI/UXãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

### 1. ãƒ‡ã‚¶ã‚¤ãƒ³å“²å­¦ï¼šã€Œé«˜ç´šæ„Ÿã¨è¦ªã—ã¿ã‚„ã™ã•ã®èª¿å’Œã€

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ
- **é«˜ç´šæ„Ÿ**: æ´—ç·´ã•ã‚ŒãŸãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã€ä¸Šè³ªãªç´ ææ„Ÿã€ç´°éƒ¨ã¸ã®ã“ã ã‚ã‚Š
- **è¦ªã—ã¿ã‚„ã™ã•**: å°å­¦ç”Ÿã«ã‚‚ç†è§£ã—ã‚„ã™ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€æ¸©ã‹ã¿ã®ã‚ã‚‹è¡¨ç¾
- **ä¿¡é ¼æ€§**: æ•™è‚²ã‚µãƒ¼ãƒ“ã‚¹ã«ãµã•ã‚ã—ã„å“æ ¼ã¨å®‰å¿ƒæ„Ÿ
- **å…ˆé€²æ€§**: æœ€æ–°ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’å–ã‚Šå…¥ã‚ŒãŸæœªæ¥çš„ãªä½“é¨“

### 2. ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆï¼ˆå¿ƒç†å­¦ãƒ™ãƒ¼ã‚¹ï¼‰

```scss
// ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼ï¼šçŸ¥æ€§ã¨ä¿¡é ¼ã‚’è¡¨ç¾
$primary: #2563EB;      // æ·±ã„ãƒ–ãƒ«ãƒ¼ï¼ˆæ˜å’Œé«˜æ ¡ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰
$primary-light: #3B82F6; // æ˜ã‚‹ã„ãƒ–ãƒ«ãƒ¼
$primary-dark: #1E40AF;  // æ¿ƒã„ãƒ–ãƒ«ãƒ¼

// ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚«ãƒ©ãƒ¼ï¼šæ¸©ã‹ã¿ã¨æˆé•·ã‚’è¡¨ç¾
$secondary: #059669;     // æ·±ã„ã‚°ãƒªãƒ¼ãƒ³ï¼ˆæˆé•·ãƒ»å¸Œæœ›ï¼‰
$secondary-light: #10B981; // æ˜ã‚‹ã„ã‚°ãƒªãƒ¼ãƒ³
$accent: #F59E0B;       // ã‚´ãƒ¼ãƒ«ãƒ‰ï¼ˆé”æˆæ„Ÿãƒ»ç‰¹åˆ¥æ„Ÿï¼‰

// ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«ã‚«ãƒ©ãƒ¼ï¼šä¸Šè³ªã•ã¨èª­ã¿ã‚„ã™ã•
$neutral-50: #F8FAFC;   // æœ€ã‚‚è–„ã„ã‚°ãƒ¬ãƒ¼ï¼ˆèƒŒæ™¯ï¼‰
$neutral-100: #F1F5F9;  // è–„ã„ã‚°ãƒ¬ãƒ¼
$neutral-200: #E2E8F0;  // ã‚°ãƒ¬ãƒ¼ï¼ˆå¢ƒç•Œç·šï¼‰
$neutral-600: #475569;  // ä¸­é–“ã‚°ãƒ¬ãƒ¼ï¼ˆãƒ†ã‚­ã‚¹ãƒˆï¼‰
$neutral-800: #1E293B;  // æ¿ƒã„ã‚°ãƒ¬ãƒ¼ï¼ˆãƒ¡ã‚¤ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰
$neutral-900: #0F172A;  // æœ€ã‚‚æ¿ƒã„ã‚°ãƒ¬ãƒ¼

// æ„Ÿæƒ…è¡¨ç¾ã‚«ãƒ©ãƒ¼
$success: #10B981;      // æˆåŠŸãƒ»æ­£è§£
$warning: #F59E0B;      // æ³¨æ„ãƒ»æ”¹å–„ææ¡ˆ
$error: #EF4444;        // ã‚¨ãƒ©ãƒ¼ãƒ»é–“é•ã„
$info: #3B82F6;         // æƒ…å ±ãƒ»ãƒ’ãƒ³ãƒˆ

// ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆé«˜ç´šæ„Ÿæ¼”å‡ºï¼‰
$gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
$gradient-success: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
$gradient-premium: linear-gradient(135deg, #f093fb 0%, #f5576c 50%, #4facfe 100%);
```

### 3. ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£ã‚·ã‚¹ãƒ†ãƒ 

```scss
// ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ãƒŸãƒªãƒ¼ï¼ˆå¤šå±¤ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
$font-primary: 'Hiragino Sans', 'Yu Gothic UI', 'Meiryo UI', sans-serif;
$font-display: 'SF Pro Display', 'Hiragino Sans', sans-serif; // è¦‹å‡ºã—ç”¨
$font-mono: 'SF Mono', 'Consolas', 'Menlo', monospace;

// ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºï¼ˆå°å­¦ç”Ÿé…æ…® + é«˜ç´šæ„Ÿï¼‰
$text-xs: 12px;    // è£œåŠ©æƒ…å ±
$text-sm: 14px;    // ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³
$text-base: 16px;  // åŸºæœ¬ãƒ†ã‚­ã‚¹ãƒˆï¼ˆèª­ã¿ã‚„ã™ã•é‡è¦–ï¼‰
$text-lg: 18px;    // é‡è¦ãƒ†ã‚­ã‚¹ãƒˆ
$text-xl: 20px;    // ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«
$text-2xl: 24px;   // ã‚¿ã‚¤ãƒˆãƒ«
$text-3xl: 30px;   // å¤§è¦‹å‡ºã—
$text-4xl: 36px;   // ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¿ã‚¤ãƒˆãƒ«

// ãƒ•ã‚©ãƒ³ãƒˆã‚¦ã‚§ã‚¤ãƒˆ
$font-light: 300;
$font-normal: 400;
$font-medium: 500; // UIè¦ç´ 
$font-semibold: 600; // å¼·èª¿
$font-bold: 700;   // è¦‹å‡ºã—

// è¡Œé–“ï¼ˆå¯èª­æ€§æœ€é©åŒ–ï¼‰
$leading-tight: 1.25;  // ã‚¿ã‚¤ãƒˆãƒ«ç”¨
$leading-normal: 1.5;  // æœ¬æ–‡ç”¨ï¼ˆå°å­¦ç”Ÿã«æœ€é©ï¼‰
$leading-relaxed: 1.625; // é•·æ–‡ç”¨
```

### 4. é«˜ç´šæ„Ÿã‚’æ¼”å‡ºã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 

#### 4.1 ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚«ãƒ¼ãƒ‰
```tsx
interface PremiumCardProps {
  variant?: 'default' | 'elevated' | 'glass' | 'gradient';
  children: React.ReactNode;
  className?: string;
}

export const PremiumCard: React.FC<PremiumCardProps> = ({ 
  variant = 'default', 
  children, 
  className 
}) => {
  const variants = {
    default: `
      bg-white border border-neutral-200 
      shadow-sm hover:shadow-md transition-all duration-300
    `,
    elevated: `
      bg-white shadow-xl hover:shadow-2xl 
      transition-all duration-500 transform hover:-translate-y-1
      border-0 backdrop-blur-sm
    `,
    glass: `
      bg-white/80 backdrop-blur-md border border-white/20
      shadow-xl hover:bg-white/90 transition-all duration-300
    `,
    gradient: `
      bg-gradient-to-br from-white via-blue-50 to-indigo-50
      border border-blue-100 shadow-lg hover:shadow-xl
      transition-all duration-300
    `
  };

  return (
    <div className={`
      rounded-xl p-6 ${variants[variant]} ${className}
      before:absolute before:inset-0 before:rounded-xl 
      before:bg-gradient-to-r before:from-primary/5 before:to-secondary/5
      before:opacity-0 hover:before:opacity-100 before:transition-opacity
      relative overflow-hidden
    `}>
      {children}
      
      {/* é«˜ç´šæ„Ÿã‚’æ¼”å‡ºã™ã‚‹ã‚·ãƒ£ã‚¤ãƒ³åŠ¹æœ */}
      <div className="absolute inset-0 rounded-xl opacity-0 hover:opacity-100 transition-opacity duration-700">
        <div className="absolute -top-2 -left-2 w-4 h-4 bg-gradient-to-br from-white to-transparent rounded-full animate-pulse" />
      </div>
    </div>
  );
};
```

#### 4.2 ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒœã‚¿ãƒ³
```tsx
interface PremiumButtonProps {
  variant?: 'primary' | 'secondary' | 'success' | 'premium';
  size?: 'sm' | 'md' | 'lg' | 'xl';
  children: React.ReactNode;
  onClick?: () => void;
  disabled?: boolean;
  loading?: boolean;
  icon?: React.ReactNode;
}

export const PremiumButton: React.FC<PremiumButtonProps> = ({
  variant = 'primary',
  size = 'md',
  children,
  onClick,
  disabled = false,
  loading = false,
  icon
}) => {
  const [isPressed, setIsPressed] = useState(false);
  const [ripples, setRipples] = useState<Array<{id: string, x: number, y: number}>>([]);

  const variants = {
    primary: `
      bg-gradient-to-r from-primary to-primary-dark text-white
      hover:from-primary-dark hover:to-primary
      shadow-lg hover:shadow-xl active:shadow-md
      border-0
    `,
    secondary: `
      bg-gradient-to-r from-neutral-100 to-neutral-200 text-neutral-800
      hover:from-neutral-200 hover:to-neutral-300
      border border-neutral-300 hover:border-neutral-400
    `,
    success: `
      bg-gradient-to-r from-success to-secondary text-white
      hover:from-secondary hover:to-success
      shadow-lg hover:shadow-xl
    `,
    premium: `
      bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500
      text-white shadow-xl hover:shadow-2xl
      relative overflow-hidden
      before:absolute before:inset-0 before:bg-gradient-to-r 
      before:from-purple-600 before:via-pink-600 before:to-orange-600
      before:opacity-0 hover:before:opacity-100 before:transition-opacity
    `
  };

  const sizes = {
    sm: 'px-4 py-2 text-sm min-h-[36px] rounded-lg',
    md: 'px-6 py-3 text-base min-h-[44px] rounded-xl',
    lg: 'px-8 py-4 text-lg min-h-[52px] rounded-xl',
    xl: 'px-10 py-5 text-xl min-h-[60px] rounded-2xl'
  };

  const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {
    if (disabled || loading) return;

    // ãƒªãƒƒãƒ—ãƒ«åŠ¹æœ
    const rect = e.currentTarget.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    const newRipple = { id: Date.now().toString(), x, y };
    
    setRipples(prev => [...prev, newRipple]);
    setTimeout(() => {
      setRipples(prev => prev.filter(ripple => ripple.id !== newRipple.id));
    }, 600);

    // è§¦è¦šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
    if (navigator.vibrate && !disabled) {
      navigator.vibrate(10);
    }

    onClick?.();
  };

  return (
    <button
      className={`
        relative inline-flex items-center justify-center font-medium
        transition-all duration-300 transform
        ${variants[variant]} ${sizes[size]}
        ${disabled ? 'opacity-50 cursor-not-allowed' : 'hover:scale-105 active:scale-95'}
        ${isPressed ? 'scale-95' : ''}
        focus:outline-none focus:ring-4 focus:ring-primary/20
        overflow-hidden
      `}
      onClick={handleClick}
      onMouseDown={() => setIsPressed(true)}
      onMouseUp={() => setIsPressed(false)}
      onMouseLeave={() => setIsPressed(false)}
      disabled={disabled || loading}
    >
      {/* ãƒªãƒƒãƒ—ãƒ«åŠ¹æœ */}
      {ripples.map(ripple => (
        <span
          key={ripple.id}
          className="absolute bg-white/30 rounded-full animate-ping"
          style={{
            left: ripple.x - 10,
            top: ripple.y - 10,
            width: 20,
            height: 20,
          }}
        />
      ))}

      {/* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ */}
      {loading && (
        <svg className="animate-spin -ml-1 mr-2 h-4 w-4" fill="none" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" className="opacity-25" />
          <path fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" className="opacity-75" />
        </svg>
      )}

      {/* ã‚¢ã‚¤ã‚³ãƒ³ */}
      {icon && !loading && (
        <span className="mr-2 flex items-center">{icon}</span>
      )}

      {/* ãƒ†ã‚­ã‚¹ãƒˆ */}
      <span className="relative z-10">{children}</span>

      {/* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒãƒªã‚¢ãƒ³ãƒˆç”¨ã®ã‚·ãƒ£ã‚¤ãƒ³åŠ¹æœ */}
      {variant === 'premium' && (
        <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 translate-x-[-200%] hover:translate-x-[200%] transition-transform duration-1000" />
      )}
    </button>
  );
};
```

### 5. è¦ªã—ã¿ã‚„ã™ã•ã‚’æ¼”å‡ºã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

#### 5.1 ãƒã‚¹ã‚³ãƒƒãƒˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚·ã‚¹ãƒ†ãƒ 
```tsx
interface MascotCharacterProps {
  emotion?: 'happy' | 'encouraging' | 'thinking' | 'celebrating';
  size?: 'sm' | 'md' | 'lg';
  message?: string;
  animate?: boolean;
}

export const MascotCharacter: React.FC<MascotCharacterProps> = ({
  emotion = 'happy',
  size = 'md',
  message,
  animate = true
}) => {
  const [currentEmotion, setCurrentEmotion] = useState(emotion);
  const [isBlinking, setIsBlinking] = useState(false);

  // è‡ªç„¶ãªã¾ã°ãŸãã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
  useEffect(() => {
    const blinkInterval = setInterval(() => {
      setIsBlinking(true);
      setTimeout(() => setIsBlinking(false), 150);
    }, 3000 + Math.random() * 2000);

    return () => clearInterval(blinkInterval);
  }, []);

  const emotions = {
    happy: {
      eyes: 'ğŸ˜Š',
      mouth: 'áµ•',
      color: 'from-yellow-400 to-orange-400',
      animation: 'animate-bounce'
    },
    encouraging: {
      eyes: 'âœ¨',
      mouth: 'â—¡',
      color: 'from-green-400 to-blue-400',
      animation: 'animate-pulse'
    },
    thinking: {
      eyes: 'ğŸ¤”',
      mouth: 'ã€œ',
      color: 'from-purple-400 to-pink-400',
      animation: 'animate-bob'
    },
    celebrating: {
      eyes: 'ğŸ‰',
      mouth: 'á—¢',
      color: 'from-pink-400 to-yellow-400',
      animation: 'animate-celebration'
    }
  };

  const sizes = {
    sm: 'w-16 h-16 text-xs',
    md: 'w-24 h-24 text-sm',
    lg: 'w-32 h-32 text-base'
  };

  return (
    <div className="flex flex-col items-center space-y-2">
      {/* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æœ¬ä½“ */}
      <div className={`
        relative ${sizes[size]} rounded-full
        bg-gradient-to-br ${emotions[currentEmotion].color}
        shadow-lg hover:shadow-xl transition-all duration-300
        ${animate ? emotions[currentEmotion].animation : ''}
        flex items-center justify-center
        border-4 border-white
      `}>
        {/* é¡” */}
        <div className="relative">
          {/* ç›® */}
          <div className={`text-2xl transition-all duration-150 ${isBlinking ? 'scale-y-0' : 'scale-y-100'}`}>
            {emotions[currentEmotion].eyes}
          </div>
          
          {/* å£ */}
          <div className="text-lg mt-1 text-center">
            {emotions[currentEmotion].mouth}
          </div>
        </div>

        {/* ã‚­ãƒ©ã‚­ãƒ©ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */}
        <div className="absolute -top-2 -right-2 text-yellow-400 animate-twinkle">âœ¨</div>
      </div>

      {/* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ–ãƒ« */}
      {message && (
        <div className="relative bg-white rounded-2xl px-4 py-2 shadow-lg border border-neutral-200 max-w-xs">
          <p className="text-sm text-neutral-700 text-center leading-relaxed">
            {message}
          </p>
          {/* å¹ãå‡ºã—ã®çŸ¢å° */}
          <div className="absolute -top-2 left-1/2 transform -translate-x-1/2 w-4 h-4 bg-white border-l border-t border-neutral-200 rotate-45" />
        </div>
      )}
    </div>
  );
};
```

#### 5.2 ãƒã‚¤ã‚¯ãƒ­ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
```tsx
// æˆåŠŸæ™‚ã®ã‚»ãƒ¬ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ
export const SuccessConfetti: React.FC = () => {
  const [particles, setParticles] = useState<Array<{id: string, x: number, y: number, color: string}>>([]);

  const triggerConfetti = () => {
    const colors = ['#FFD700', '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4'];
    const newParticles = Array.from({ length: 20 }, (_, i) => ({
      id: `particle-${i}`,
      x: Math.random() * window.innerWidth,
      y: -10,
      color: colors[Math.floor(Math.random() * colors.length)]
    }));

    setParticles(newParticles);
    
    setTimeout(() => setParticles([]), 3000);
  };

  return (
    <div className="fixed inset-0 pointer-events-none z-50">
      {particles.map(particle => (
        <div
          key={particle.id}
          className="absolute w-3 h-3 rounded-full animate-confetti"
          style={{
            left: particle.x,
            top: particle.y,
            backgroundColor: particle.color,
            animation: `confetti 3s ease-out forwards`
          }}
        />
      ))}
    </div>
  );
};

// å›ç­”ä¸­ã®æ³¢å½¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
export const VoiceWaveform: React.FC<{ isActive: boolean; amplitude: number }> = ({ 
  isActive, 
  amplitude 
}) => {
  return (
    <div className="flex items-center justify-center space-x-1">
      {Array.from({ length: 12 }).map((_, i) => (
        <div
          key={i}
          className={`
            w-1 bg-gradient-to-t from-primary to-secondary rounded-full
            transition-all duration-200 ease-out
            ${isActive ? 'animate-voice-wave' : 'h-2'}
          `}
          style={{
            height: isActive 
              ? `${Math.max(8, amplitude * Math.sin(Date.now() * 0.01 + i) * 20 + 20)}px`
              : '8px',
            animationDelay: `${i * 100}ms`
          }}
        />
      ))}
    </div>
  );
};
```

### 6. é«˜å“è³ªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚·ã‚¹ãƒ†ãƒ 

#### 6.1 ã‚¢ãƒ€ãƒ—ãƒ†ã‚£ãƒ–ã‚°ãƒªãƒƒãƒ‰
```scss
// é«˜ç´šæ„Ÿã®ã‚ã‚‹ã‚¹ãƒšãƒ¼ã‚·ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ 
$spacing-scale: (
  'xs': 0.25rem,   // 4px
  'sm': 0.5rem,    // 8px  
  'md': 1rem,      // 16px
  'lg': 1.5rem,    // 24px
  'xl': 2rem,      // 32px
  '2xl': 3rem,     // 48px
  '3xl': 4rem,     // 64px
  '4xl': 6rem,     // 96px
);

// é»„é‡‘æ¯”ãƒ™ãƒ¼ã‚¹ã®æ¯”ç‡
$golden-ratio: 1.618;
$spacing-golden: (
  'phi-1': 1rem,
  'phi-2': #{1rem * $golden-ratio},     // 25.9px â‰ˆ 26px
  'phi-3': #{1rem * $golden-ratio * $golden-ratio}, // 41.8px â‰ˆ 42px
);

// ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚·ãƒ£ãƒ‰ã‚¦ã‚·ã‚¹ãƒ†ãƒ 
$shadows: (
  'soft': '0 2px 4px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.02)',
  'medium': '0 4px 8px rgba(0,0,0,0.08), 0 2px 4px rgba(0,0,0,0.04)',
  'large': '0 8px 16px rgba(0,0,0,0.12), 0 4px 8px rgba(0,0,0,0.08)',
  'premium': '0 20px 40px rgba(0,0,0,0.15), 0 8px 16px rgba(0,0,0,0.1)',
  'glow': '0 0 20px rgba(37, 99, 235, 0.3), 0 0 40px rgba(37, 99, 235, 0.1)'
);
```

#### 6.2 é¢æ¥ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”»é¢ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
```tsx
export const InterviewSessionLayout: React.FC = () => {
  return (
    <div className="min-h-screen bg-gradient-to-br from-neutral-50 via-blue-50 to-indigo-50">
      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ï¼šé€²æ—ã¨ã‚¿ã‚¤ãƒãƒ¼ */}
      <header className="sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-neutral-200">
        <div className="max-w-4xl mx-auto px-6 py-4">
          <div className="flex items-center justify-between">
            {/* é€²æ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}
            <div className="flex items-center space-x-4">
              <MascotCharacter 
                emotion="encouraging" 
                size="sm" 
                message="ãŒã‚“ã°ã£ã¦ï¼"
              />
              <ProgressIndicator current={3} total={5} />
            </div>

            {/* ã‚¿ã‚¤ãƒãƒ¼ */}
            <PremiumTimer 
              timeRemaining={720} // 12åˆ†æ®‹ã‚Š
              totalTime={900}     // 15åˆ†
              className="text-lg font-semibold"
            />
          </div>
        </div>
      </header>

      {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
      <main className="max-w-4xl mx-auto px-6 py-8">
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          {/* è³ªå•è¡¨ç¤ºã‚¨ãƒªã‚¢ */}
          <div className="lg:col-span-2">
            <PremiumCard variant="elevated" className="mb-6">
              <div className="text-center mb-6">
                <h2 className="text-2xl font-bold text-neutral-800 mb-2">
                  è³ªå• 3/5
                </h2>
                <div className="w-20 h-1 bg-gradient-to-r from-primary to-secondary rounded-full mx-auto" />
              </div>

              <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 mb-6">
                <p className="text-lg leading-relaxed text-neutral-800">
                  ã‚ãªãŸãŒèª¿ã¹ãŸã€Œæµ·æ´‹ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯å•é¡Œã€ã«ã¤ã„ã¦ã€
                  ä¸€ç•ªå°è±¡ã«æ®‹ã£ãŸã“ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ
                </p>
              </div>

              {/* éŸ³å£°å…¥åŠ›ã‚¨ãƒªã‚¢ */}
              <div className="text-center">
                <VoiceInputArea />
              </div>
            </PremiumCard>
          </div>

          {/* ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ« */}
          <div className="space-y-6">
            {/* ãƒ’ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰ */}
            <PremiumCard variant="glass">
              <h3 className="font-semibold text-neutral-800 mb-3 flex items-center">
                <span className="mr-2">ğŸ’¡</span>
                ç­”ãˆæ–¹ã®ã‚³ãƒ„
              </h3>
              <ul className="text-sm text-neutral-600 space-y-2">
                <li>â€¢ å…·ä½“çš„ãªäº‹å®Ÿã‚„æ•°å­—ã‚’ä½¿ã£ã¦</li>
                <li>â€¢ è‡ªåˆ†ã®æ„Ÿæƒ³ã‚‚å«ã‚ã¦</li>
                <li>â€¢ 2-3åˆ†ç¨‹åº¦ã§ç­”ãˆã¾ã—ã‚‡ã†</li>
              </ul>
            </PremiumCard>

            {/* åŠ±ã¾ã—ã‚«ãƒ¼ãƒ‰ */}
            <PremiumCard variant="gradient">
              <div className="text-center">
                <div className="text-3xl mb-2">ğŸŒŸ</div>
                <p className="text-sm font-medium text-neutral-700">
                  è½ã¡ç€ã„ã¦ã€ã‚†ã£ãã‚Šè©±ã—ã¦ã­ï¼
                </p>
              </div>
            </PremiumCard>
          </div>
        </div>
      </main>
    </div>
  );
};
```

## ğŸ“± ãƒ¢ãƒã‚¤ãƒ«ç‰¹åŒ–å®Ÿè£…

### 1. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆTailwind CSSï¼‰

```typescript
// tailwind.config.js
module.exports = {
  content: ['./src/**/*.{js,ts,jsx,tsx}'],
  theme: {
    screens: {
      'xs': '475px',
      'sm': '640px',
      'md': '768px',
      'lg': '1024px',
      'xl': '1280px',
      '2xl': '1536px',
    },
    extend: {
      spacing: {
        '18': '4.5rem',
        '88': '22rem',
        '128': '32rem',
      },
      fontSize: {
        'xs': ['12px', '16px'],
        'sm': ['14px', '20px'],
        'base': ['16px', '24px'],
        'lg': ['18px', '28px'],
        'xl': ['20px', '28px'],
        '2xl': ['24px', '32px'],
        '3xl': ['30px', '36px'],
      },
      colors: {
        'meiwa-blue': '#1E40AF',
        'meiwa-light': '#DBEAFE',
        'success-green': '#10B981',
        'warning-yellow': '#F59E0B',
        'error-red': '#EF4444',
      },
      minHeight: {
        'touch-target': '44px', // iOSæ¨å¥¨ã‚¿ãƒƒãƒã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚µã‚¤ã‚º
      },
      animation: {
        'pulse-soft': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
        'bounce-subtle': 'bounce 1s ease-in-out 2',
      }
    },
  },
  plugins: [
    require('@tailwindcss/forms'),
    require('@tailwindcss/typography'),
  ],
}
```

### 7. ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£å‘ä¸Šæ©Ÿèƒ½

#### 7.1 ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
```tsx
export const SmartNavigation: React.FC = () => {
  const [navigationHistory, setNavigationHistory] = useState<string[]>([]);
  const [userIntent, setUserIntent] = useState<'browsing' | 'focused' | 'struggling'>('browsing');

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ
  const analyzeUserBehavior = useCallback(() => {
    const recent = navigationHistory.slice(-5);
    
    if (recent.includes('help') || recent.includes('hint')) {
      setUserIntent('struggling');
    } else if (recent.length > 0 && recent.every(path => path.startsWith('/interview'))) {
      setUserIntent('focused');
    } else {
      setUserIntent('browsing');
    }
  }, [navigationHistory]);

  // é©å¿œçš„ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ææ¡ˆ
  const getNavigationSuggestions = () => {
    switch (userIntent) {
      case 'struggling':
        return [
          { label: 'ãƒ˜ãƒ«ãƒ—ã‚’è¦‹ã‚‹', path: '/help', icon: 'ğŸ†˜' },
          { label: 'ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«', path: '/tutorial', icon: 'ğŸ“š' },
          { label: 'ã‚µãƒãƒ¼ãƒˆã«é€£çµ¡', path: '/support', icon: 'ğŸ’¬' }
        ];
      case 'focused':
        return [
          { label: 'å‰ã®è³ªå•ã«æˆ»ã‚‹', path: '/interview/previous', icon: 'â¬…ï¸' },
          { label: 'ç·´ç¿’ã‚’å†é–‹', path: '/interview/continue', icon: 'â–¶ï¸' },
          { label: 'çµæœã‚’ç¢ºèª', path: '/results', icon: 'ğŸ“Š' }
        ];
      default:
        return [
          { label: 'é¢æ¥ç·´ç¿’é–‹å§‹', path: '/interview/start', icon: 'ğŸ¤' },
          { label: 'éå»ã®è¨˜éŒ²', path: '/history', icon: 'ğŸ“ˆ' },
          { label: 'è¨­å®š', path: '/settings', icon: 'âš™ï¸' }
        ];
    }
  };

  return (
    <nav className="bg-white/90 backdrop-blur-md border-b border-neutral-200 sticky top-0 z-50">
      <div className="max-w-6xl mx-auto px-4">
        <div className="flex items-center justify-between h-16">
          {/* ãƒ­ã‚´ã¨ãƒ–ãƒ©ãƒ³ãƒ‰ */}
          <div className="flex items-center space-x-3">
            <div className="w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-xl flex items-center justify-center">
              <span className="text-white text-xl font-bold">é¢</span>
            </div>
            <h1 className="text-xl font-bold text-neutral-800">é¢æ¥ç·´ç¿’ã‚¢ãƒ—ãƒª</h1>
          </div>

          {/* é©å¿œçš„ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}
          <div className="flex items-center space-x-2">
            {getNavigationSuggestions().map((suggestion, index) => (
              <PremiumButton
                key={index}
                variant="secondary"
                size="sm"
                icon={<span>{suggestion.icon}</span>}
                onClick={() => router.push(suggestion.path)}
              >
                {suggestion.label}
              </PremiumButton>
            ))}
          </div>
        </div>
      </div>
    </nav>
  );
};
```

#### 7.2 ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¼·åŒ–ã‚·ã‚¹ãƒ†ãƒ 
```tsx
export const AccessibilityEnhancer: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [highContrast, setHighContrast] = useState(false);
  const [largeText, setLargeText] = useState(false);
  const [reduceMotion, setReduceMotion] = useState(false);
  const [voiceNavigation, setVoiceNavigation] = useState(false);

  // éŸ³å£°ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
  const handleVoiceCommand = useCallback((command: string) => {
    const commands = {
      'é¢æ¥é–‹å§‹': () => router.push('/interview/start'),
      'ãƒ’ãƒ³ãƒˆ': () => showHints(),
      'æˆ»ã‚‹': () => router.back(),
      'çµæœ': () => router.push('/results'),
      'ãƒ˜ãƒ«ãƒ—': () => router.push('/help')
    };

    const matchedCommand = Object.keys(commands).find(cmd => 
      command.includes(cmd)
    );

    if (matchedCommand) {
      commands[matchedCommand as keyof typeof commands]();
      announceToScreenReader(`${matchedCommand}ã‚’å®Ÿè¡Œã—ã¾ã—ãŸ`);
    }
  }, []);

  const announceToScreenReader = (message: string) => {
    const announcement = document.createElement('div');
    announcement.setAttribute('aria-live', 'polite');
    announcement.setAttribute('aria-atomic', 'true');
    announcement.className = 'sr-only';
    announcement.textContent = message;
    document.body.appendChild(announcement);
    setTimeout(() => document.body.removeChild(announcement), 1000);
  };

  return (
    <div className={`
      ${highContrast ? 'filter contrast-125 brightness-110' : ''}
      ${largeText ? 'text-lg' : ''}
      ${reduceMotion ? '[&_*]:!animate-none [&_*]:!transition-none' : ''}
    `}>
      {/* ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ */}
      <div className="fixed top-20 right-4 z-60 opacity-30 hover:opacity-100 transition-opacity">
        <PremiumCard variant="glass" className="p-3">
          <div className="flex flex-col space-y-2">
            <button
              onClick={() => setHighContrast(!highContrast)}
              className="p-2 rounded-lg hover:bg-neutral-100 text-xs"
              title="ãƒã‚¤ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ"
            >
              ğŸ¯
            </button>
            <button
              onClick={() => setLargeText(!largeText)}
              className="p-2 rounded-lg hover:bg-neutral-100 text-xs"
              title="å¤§ããªæ–‡å­—"
            >
              ğŸ”
            </button>
            <button
              onClick={() => setReduceMotion(!reduceMotion)}
              className="p-2 rounded-lg hover:bg-neutral-100 text-xs"
              title="ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å‰Šæ¸›"
            >
              â¸ï¸
            </button>
            <button
              onClick={() => setVoiceNavigation(!voiceNavigation)}
              className="p-2 rounded-lg hover:bg-neutral-100 text-xs"
              title="éŸ³å£°æ“ä½œ"
            >
              ğŸ™ï¸
            </button>
          </div>
        </PremiumCard>
      </div>

      {children}
    </div>
  );
};
```
```

### 2. éŸ³å£°å…¥åŠ›ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// components/VoiceInput.tsx
interface VoiceInputProps {
  onTranscript: (transcript: string) => void;
  onError: (error: string) => void;
  maxDuration?: number;
  language?: string;
}

export const VoiceInput: React.FC<VoiceInputProps> = ({
  onTranscript,
  onError,
  maxDuration = 180, // 3åˆ†
  language = 'ja-JP'
}) => {
  const [isRecording, setIsRecording] = useState(false);
  const [transcript, setTranscript] = useState('');
  const [audioLevel, setAudioLevel] = useState(0);
  const recognitionRef = useRef<SpeechRecognition | null>(null);
  const audioContextRef = useRef<AudioContext | null>(null);
  const timerRef = useRef<NodeJS.Timeout | null>(null);
  
  useEffect(() => {
    // Speech Recognition ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognitionRef.current = new SpeechRecognition();
      
      const recognition = recognitionRef.current;
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = language;
      
      recognition.onresult = (event) => {
        let finalTranscript = '';
        let interimTranscript = '';
        
        for (let i = 0; i < event.results.length; i++) {
          const result = event.results[i];
          if (result.isFinal) {
            finalTranscript += result[0].transcript;
          } else {
            interimTranscript += result[0].transcript;
          }
        }
        
        const fullTranscript = finalTranscript + interimTranscript;
        setTranscript(fullTranscript);
        onTranscript(fullTranscript);
      };
      
      recognition.onerror = (event) => {
        console.error('Speech recognition error:', event.error);
        setIsRecording(false);
        onError(`éŸ³å£°èªè­˜ã‚¨ãƒ©ãƒ¼: ${event.error}`);
      };
      
      recognition.onend = () => {
        setIsRecording(false);
      };
    } else {
      onError('ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°èªè­˜ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“');
    }
    
    return () => {
      if (recognitionRef.current) {
        recognitionRef.current.stop();
      }
      if (timerRef.current) {
        clearTimeout(timerRef.current);
      }
    };
  }, [language, onError, onTranscript]);
  
  const startRecording = async () => {
    try {
      // ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ç¢ºèª
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      
      // éŸ³é‡ãƒ¬ãƒ™ãƒ«æ¤œå‡ºã®ãŸã‚ã®AudioContext
      audioContextRef.current = new AudioContext();
      const source = audioContextRef.current.createMediaStreamSource(stream);
      const analyzer = audioContextRef.current.createAnalyser();
      source.connect(analyzer);
      
      // éŸ³é‡ãƒ¬ãƒ™ãƒ«ã®ç›£è¦–
      const dataArray = new Uint8Array(analyzer.frequencyBinCount);
      const updateAudioLevel = () => {
        if (!isRecording) return;
        
        analyzer.getByteFrequencyData(dataArray);
        const average = dataArray.reduce((a, b) => a + b) / dataArray.length;
        setAudioLevel(average);
        requestAnimationFrame(updateAudioLevel);
      };
      
      setIsRecording(true);
      setTranscript('');
      
      if (recognitionRef.current) {
        recognitionRef.current.start();
      }
      
      updateAudioLevel();
      
      // æœ€å¤§éŒ²éŸ³æ™‚é–“ã®åˆ¶é™
      timerRef.current = setTimeout(() => {
        stopRecording();
      }, maxDuration * 1000);
      
    } catch (error) {
      onError('ãƒã‚¤ã‚¯ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒè¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“');
    }
  };
  
  const stopRecording = () => {
    setIsRecording(false);
    setAudioLevel(0);
    
    if (recognitionRef.current) {
      recognitionRef.current.stop();
    }
    
    if (audioContextRef.current) {
      audioContextRef.current.close();
    }
    
    if (timerRef.current) {
      clearTimeout(timerRef.current);
    }
  };
  
  return (
    <div className="flex flex-col items-center space-y-4 p-6">
      {/* éŒ²éŸ³ãƒœã‚¿ãƒ³ */}
      <button
        onClick={isRecording ? stopRecording : startRecording}
        className={`
          relative w-24 h-24 rounded-full flex items-center justify-center
          transition-all duration-200 shadow-lg min-h-touch-target
          ${isRecording 
            ? 'bg-error-red text-white scale-110' 
            : 'bg-meiwa-blue text-white hover:bg-blue-600'
          }
        `}
        disabled={!recognitionRef.current}
      >
        {isRecording ? (
          <>
            <StopIcon className="w-8 h-8" />
            <div 
              className="absolute inset-0 rounded-full border-4 border-white opacity-70"
              style={{
                transform: `scale(${1 + audioLevel / 100})`,
                transition: 'transform 0.1s ease-out'
              }}
            />
          </>
        ) : (
          <MicrophoneIcon className="w-8 h-8" />
        )}
      </button>
      
      {/* éŒ²éŸ³çŠ¶æ…‹è¡¨ç¤º */}
      <div className="text-center">
        {isRecording ? (
          <div className="flex items-center space-x-2">
            <div className="w-3 h-3 bg-error-red rounded-full animate-pulse" />
            <span className="text-sm text-gray-600">éŒ²éŸ³ä¸­...</span>
          </div>
        ) : (
          <span className="text-sm text-gray-500">ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦è©±ã—ã¦ãã ã•ã„</span>
        )}
      </div>
      
      {/* éŸ³å£°æ³¢å½¢è¡¨ç¤º */}
      {isRecording && (
        <div className="flex items-center space-x-1">
          {Array.from({ length: 20 }).map((_, i) => (
            <div
              key={i}
              className="w-1 bg-meiwa-blue rounded-full transition-all duration-100"
              style={{
                height: `${Math.max(4, (audioLevel / 5) * Math.random() * 20)}px`
              }}
            />
          ))}
        </div>
      )}
      
      {/* èªè­˜çµæœè¡¨ç¤º */}
      {transcript && (
        <div className="w-full max-w-md p-4 bg-gray-50 rounded-lg">
          <p className="text-sm text-gray-700 leading-relaxed">
            {transcript}
          </p>
        </div>
      )}
    </div>
  );
};
```

### 3. ã‚¿ãƒƒãƒæœ€é©åŒ–UI

```typescript
// components/TouchOptimizedButton.tsx
interface TouchButtonProps {
  children: React.ReactNode;
  onClick: () => void;
  variant?: 'primary' | 'secondary' | 'danger';
  size?: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  loading?: boolean;
}

export const TouchOptimizedButton: React.FC<TouchButtonProps> = ({
  children,
  onClick,
  variant = 'primary',
  size = 'md',
  disabled = false,
  loading = false
}) => {
  const [isPressed, setIsPressed] = useState(false);
  
  const baseClasses = `
    relative inline-flex items-center justify-center
    font-medium rounded-lg transition-all duration-150
    focus:outline-none focus:ring-2 focus:ring-offset-2
    disabled:opacity-50 disabled:cursor-not-allowed
    active:scale-95
  `;
  
  const variantClasses = {
    primary: 'bg-meiwa-blue text-white hover:bg-blue-600 focus:ring-blue-500',
    secondary: 'bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500',
    danger: 'bg-error-red text-white hover:bg-red-600 focus:ring-red-500'
  };
  
  const sizeClasses = {
    sm: 'px-4 py-2 text-sm min-h-[36px]',
    md: 'px-6 py-3 text-base min-h-[44px]', // iOSæ¨å¥¨æœ€å°ã‚µã‚¤ã‚º
    lg: 'px-8 py-4 text-lg min-h-[52px]'
  };
  
  const handleTouchStart = () => {
    setIsPressed(true);
    // è§¦è¦šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆå¯¾å¿œãƒ‡ãƒã‚¤ã‚¹ã®ã¿ï¼‰
    if (navigator.vibrate) {
      navigator.vibrate(10);
    }
  };
  
  const handleTouchEnd = () => {
    setIsPressed(false);
  };
  
  return (
    <button
      className={`${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]} ${
        isPressed ? 'transform scale-95' : ''
      }`}
      onClick={onClick}
      disabled={disabled || loading}
      onTouchStart={handleTouchStart}
      onTouchEnd={handleTouchEnd}
      onMouseDown={handleTouchStart}
      onMouseUp={handleTouchEnd}
      onMouseLeave={handleTouchEnd}
    >
      {loading && (
        <svg className="animate-spin -ml-1 mr-2 h-4 w-4" fill="none" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" className="opacity-25" />
          <path fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" className="opacity-75" />
        </svg>
      )}
      {children}
    </button>
  );
};
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãƒ»DevOps

### 1. Dockerè¨­å®š

```dockerfile
# Dockerfile
FROM node:18-alpine AS builder

WORKDIR /app

# Dependencies
COPY package.json package-lock.json ./
RUN npm ci --only=production

# Build
COPY . .
RUN npm run build

# Production image
FROM node:18-alpine AS runner

WORKDIR /app

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: non-root user
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

# ã‚¢ãƒ—ãƒªãƒ•ã‚¡ã‚¤ãƒ«
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/package.json ./package.json

# æ¨©é™è¨­å®š
USER nextjs

EXPOSE 3000

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3000/health || exit 1

CMD ["npm", "start"]
```

### 2. docker-compose.yml

```yaml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DATABASE_URL=postgres://user:password@db:5432/interview_app
      - REDIS_URL=redis://redis:6379
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - JWT_SECRET=${JWT_SECRET}
    depends_on:
      - db
      - redis
    restart: unless-stopped
    
  db:
    image: postgres:15-alpine
    environment:
      - POSTGRES_DB=interview_app
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    restart: unless-stopped
    
  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data
    restart: unless-stopped
    
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - app
    restart: unless-stopped

volumes:
  postgres_data:
  redis_data:
```

### 3. CI/CD Pipelineï¼ˆGitHub Actionsï¼‰

```yaml
# .github/workflows/deploy.yml
name: Deploy Interview Practice App

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run tests
      run: npm run test
      
    - name: Run type check
      run: npm run type-check
      
    - name: Run linting
      run: npm run lint
      
    - name: Build application
      run: npm run build

  security-scan:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Run security audit
      run: npm audit --audit-level=moderate
      
    - name: Run Snyk scan
      uses: snyk/actions/node@master
      env:
        SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}

  deploy:
    needs: [test, security-scan]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Docker Buildx
      uses: docker/setup-buildx-action@v2
      
    - name: Login to Container Registry
      uses: docker/login-action@v2
      with:
        registry: ghcr.io
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}
        
    - name: Build and push Docker image
      uses: docker/build-push-action@v4
      with:
        context: .
        push: true
        tags: ghcr.io/${{ github.repository }}:latest
        cache-from: type=gha
        cache-to: type=gha,mode=max
        
    - name: Deploy to production
      uses: appleboy/ssh-action@v0.1.5
      with:
        host: ${{ secrets.HOST }}
        username: ${{ secrets.USERNAME }}
        key: ${{ secrets.SSH_KEY }}
        script: |
          cd /opt/interview-app
          docker-compose pull
          docker-compose up -d
          docker system prune -f

  notify:
    needs: [deploy]
    runs-on: ubuntu-latest
    if: always()
    
    steps:
    - name: Notify deployment status
      # Slack/Discord notification
      run: echo "Deployment completed"
```

### 4. ç›£è¦–ãƒ»ãƒ­ã‚°è¨­å®š

```typescript
// monitoring/logger.ts
import winston from 'winston';

const logger = winston.createLogger({
  level: process.env.LOG_LEVEL || 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.errors({ stack: true }),
    winston.format.json()
  ),
  defaultMeta: {
    service: 'interview-practice-app',
    version: process.env.APP_VERSION || '1.0.0'
  },
  transports: [
    new winston.transports.File({ 
      filename: 'logs/error.log', 
      level: 'error',
      maxsize: 5242880, // 5MB
      maxFiles: 10
    }),
    new winston.transports.File({ 
      filename: 'logs/combined.log',
      maxsize: 5242880,
      maxFiles: 10
    })
  ]
});

// ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç’°å¢ƒã§ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
if (process.env.NODE_ENV !== 'production') {
  logger.add(new winston.transports.Console({
    format: winston.format.simple()
  }));
}

// ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ¡ãƒˆãƒªã‚¯ã‚¹
export class MetricsCollector {
  private metrics: Map<string, number> = new Map();
  
  incrementCounter(name: string, value: number = 1): void {
    const current = this.metrics.get(name) || 0;
    this.metrics.set(name, current + value);
  }
  
  recordDuration(name: string, startTime: number): void {
    const duration = Date.now() - startTime;
    this.metrics.set(`${name}_duration_ms`, duration);
  }
  
  async recordAIUsage(model: string, tokens: number, cost: number): Promise<void> {
    this.incrementCounter(`ai_requests_${model}`);
    this.incrementCounter('ai_tokens_total', tokens);
    this.incrementCounter('ai_cost_total_yen', Math.round(cost * 100)); // éŠ­å˜ä½
    
    logger.info('AI API usage recorded', {
      model,
      tokens,
      cost_yen: cost,
      timestamp: new Date().toISOString()
    });
  }
  
  getMetrics(): Record<string, number> {
    return Object.fromEntries(this.metrics);
  }
  
  resetMetrics(): void {
    this.metrics.clear();
  }
}

export { logger };
```

## ğŸ“‹ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

## ğŸ’° ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å“è³ªé‹ç”¨ã‚³ã‚¹ãƒˆ

### æœˆé¡é‹ç”¨ã‚³ã‚¹ãƒˆè©¦ç®—ï¼ˆå“è³ªé‡è¦–ï¼‰

#### AI API ã‚µãƒ¼ãƒ“ã‚¹
- **OpenAI GPT-4 Turbo**: æœˆé¡ 25,000å††
  - é«˜å“è³ªè³ªå•ç”Ÿæˆãƒ»è©•ä¾¡
  - 1æ—¥å¹³å‡300ãƒªã‚¯ã‚¨ã‚¹ãƒˆ Ã— 30æ—¥
- **Anthropic Claude 3.5**: æœˆé¡ 15,000å††  
  - å¤šè§’çš„è©•ä¾¡ãƒ»å“è³ªæ¤œè¨¼
  - GPT-4ã¨ã®æ¯”è¼ƒæ¤œè¨¼ç”¨
- **Google Cloud Speech-to-Text**: æœˆé¡ 8,000å††
  - é«˜ç²¾åº¦éŸ³å£°èªè­˜ï¼ˆæœˆé–“15æ™‚é–“ï¼‰
- **Azure Speech Service**: æœˆé¡ 5,000å††
  - ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—éŸ³å£°èªè­˜
- **ElevenLabs Voice**: æœˆé¡ 12,000å††
  - è‡ªç„¶ãªæ—¥æœ¬èªéŸ³å£°åˆæˆ

#### ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ã‚µãƒ¼ãƒ“ã‚¹
- **AWS ECS Fargate**: æœˆé¡ 15,000å††
  - ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°å¯¾å¿œ
- **RDS PostgreSQL**: æœˆé¡ 8,000å††
  - Multi-AZæ§‹æˆã€è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- **ElastiCache Redis**: æœˆé¡ 6,000å††
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **CloudFront CDN**: æœˆé¡ 3,000å††
  - ã‚°ãƒ­ãƒ¼ãƒãƒ«é«˜é€Ÿé…ä¿¡
- **DataDog Monitoring**: æœˆé¡ 10,000å††
  - åŒ…æ‹¬çš„ç›£è¦–ãƒ»åˆ†æ
- **Sentry Error Tracking**: æœˆé¡ 2,000å††

#### åˆè¨ˆæœˆé¡é‹ç”¨ã‚³ã‚¹ãƒˆ: **109,000å††**
ï¼ˆåˆæœŸäºˆç®—ã®ç´„11å€ã ãŒã€åœ§å€’çš„å“è³ªå‘ä¸Šã‚’å®Ÿç¾ï¼‰

### ROIï¼ˆæŠ•è³‡å¯¾åŠ¹æœï¼‰åˆ†æ

#### å“è³ªå‘ä¸Šã«ã‚ˆã‚‹ä¾¡å€¤
- **éŸ³å£°èªè­˜ç²¾åº¦**: 95%ä»¥ä¸Šï¼ˆå¾“æ¥80%ï¼‰
- **AIè©•ä¾¡ç²¾åº¦**: 98%ä»¥ä¸Šï¼ˆå¾“æ¥85%ï¼‰
- **å¿œç­”é€Ÿåº¦**: å¹³å‡1.5ç§’ï¼ˆå¾“æ¥5ç§’ï¼‰
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦**: 4.8/5.0ï¼ˆå¾“æ¥3.8/5.0ï¼‰

#### åç›Šãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚µãƒ¼ãƒ“ã‚¹ï¼‰
- **åŸºæœ¬ãƒ—ãƒ©ãƒ³**: æœˆé¡2,980å††ï¼ˆå¾“æ¥æ©Ÿèƒ½ï¼‰
- **ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³**: æœˆé¡9,800å††ï¼ˆå…¨æ©Ÿèƒ½ï¼‰
- **æƒ³å®šãƒ¦ãƒ¼ã‚¶ãƒ¼**: 320åä¸­60%ãŒãƒ—ãƒ¬ãƒŸã‚¢ãƒ åˆ©ç”¨
- **æœˆé¡åç›Š**: 192å Ã— 9,800å†† = 1,881,600å††
- **ç²—åˆ©**: 1,881,600å†† - 109,000å†† = **1,772,600å††/æœˆ**

### Phase 1: ãƒ—ãƒ¬ãƒŸã‚¢ãƒ MVPå®Ÿè£…ï¼ˆ3ãƒ¶æœˆï¼‰

#### Week 1-2: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŸºç›¤
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆReact + TypeScript + Viteï¼‰
- [ ] Tailwind CSSè¨­å®šï¼ˆãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆï¼‰
- [ ] PWAè¨­å®šï¼ˆmanifest.json, service workerï¼‰
- [ ] åŸºæœ¬ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š
- [ ] èªè¨¼ã‚·ã‚¹ãƒ†ãƒ åŸºç›¤å®Ÿè£…

#### Week 3-4: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- [ ] Prismaè¨­å®šã¨ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
- [ ] PostgreSQLæ¥ç¶šã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] åŸºæœ¬API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- [ ] JWTèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
- [ ] å…¥åŠ›æ¤œè¨¼ï¼ˆZodï¼‰è¨­å®š

#### Week 5-6: å¿—é¡˜ç†ç”±æ›¸æ©Ÿèƒ½
- [ ] å¿—é¡˜ç†ç”±æ›¸å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆ4é …ç›®ï¼‰
- [ ] AIåˆ†æAPIçµ±åˆï¼ˆOpenAIï¼‰
- [ ] åˆ†æçµæœè¡¨ç¤ºUI
- [ ] å­¦æ ¡åˆ¥è¨­å®šï¼ˆæ˜å’Œé«˜æ ¡ãƒ‡ãƒ¼ã‚¿ï¼‰

#### Week 7-8: é¢æ¥ã‚»ãƒƒã‚·ãƒ§ãƒ³åŸºæœ¬æ©Ÿèƒ½
- [ ] ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹/ç®¡ç†
- [ ] éŸ³å£°å…¥åŠ›ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆWeb Speech APIï¼‰
- [ ] AIè³ªå•ç”Ÿæˆï¼ˆæ˜å’Œç‰¹åŒ–ï¼‰
- [ ] åŸºæœ¬ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ©Ÿèƒ½

#### Week 9-10: UI/UXæœ€é©åŒ–
- [ ] ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ã‚¹ãƒãƒ›æœ€é©åŒ–
- [ ] ã‚¿ãƒƒãƒæ“ä½œå¯¾å¿œ
- [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–

#### Week 11-12: ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…
- [ ] E2Eãƒ†ã‚¹ãƒˆè¨­å®š
- [ ] Dockerè¨­å®š
- [ ] CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- [ ] æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹
- [ ] HTTPSè¨­å®š
- [ ] CSP headersè¨­å®š
- [ ] ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–å®Ÿè£…
- [ ] GDPRå¯¾å¿œæ©Ÿèƒ½
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»

### ç›£è¦–ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
- [ ] ãƒ­ã‚°åé›†ã‚·ã‚¹ãƒ†ãƒ 
- [ ] ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–
- [ ] ã‚¨ãƒ©ãƒ¼é€šçŸ¥è¨­å®š
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è‡ªå‹•åŒ–
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

## ğŸ¨ UI/UXå®Ÿè£…æ–¹é‡

### 1. ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

#### ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
```css
:root {
  /* ãƒ—ãƒ©ã‚¤ãƒãƒªã‚«ãƒ©ãƒ¼ - è½ã¡ç€ã„ãŸé’ç³» */
  --primary-50: #EBF5FF;
  --primary-100: #C3E0FF;
  --primary-500: #3B82F6;
  --primary-600: #2563EB;
  --primary-900: #1E3A8A;
  
  /* ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚«ãƒ©ãƒ¼ - æ¸©ã‹ã¿ã®ã‚ã‚‹ç·‘ç³» */
  --secondary-50: #F0FDF4;
  --secondary-500: #22C55E;
  --secondary-600: #16A34A;
  
  /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼ - å­¦ç¿’æ„æ¬²ã‚’é«˜ã‚ã‚‹æ©™ç³» */
  --accent-300: #FDBA74;
  --accent-500: #F97316;
  
  /* ã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ« */
  --gray-50: #F9FAFB;
  --gray-100: #F3F4F6;
  --gray-900: #111827;
}
```

#### ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£
```css
/* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ã‚¹ãƒãƒ›å‘ã‘æœ€é©åŒ– */
.heading-1 {
  font-size: clamp(2rem, 5vw, 3rem);
  font-weight: 700;
  line-height: 1.2;
}

.body-text {
  font-size: clamp(1rem, 2.5vw, 1.125rem);
  line-height: 1.7;
}

/* èª­ã¿ã‚„ã™ã•é‡è¦–ã®æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆ */
body {
  font-family: -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif;
}
```

### 2. ã‚¿ãƒƒãƒæœ€é©åŒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### ã‚¿ãƒƒãƒå¯¾å¿œãƒœã‚¿ãƒ³
```typescript
const TouchButton = styled.button`
  min-height: 48px; /* ã‚¿ãƒƒãƒã‚¿ãƒ¼ã‚²ãƒƒãƒˆæœ€å°ã‚µã‚¤ã‚º */
  min-width: 48px;
  padding: 12px 24px;
  border-radius: 12px;
  transition: all 0.2s ease;
  
  /* ã‚¿ãƒƒãƒ—ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ */
  &:active {
    transform: scale(0.98);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  
  /* iPadå‘ã‘ãƒ›ãƒãƒ¼å¯¾å¿œ */
  @media (hover: hover) {
    &:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
  }
`;
```

#### ã‚¹ãƒ¯ã‚¤ãƒ—å¯¾å¿œã‚«ãƒ«ãƒ¼ã‚»ãƒ«
```typescript
const useSwipeGesture = () => {
  const [touchStart, setTouchStart] = useState(0);
  const [touchEnd, setTouchEnd] = useState(0);
  
  const handleTouchStart = (e: TouchEvent) => {
    setTouchStart(e.targetTouches[0].clientX);
  };
  
  const handleTouchMove = (e: TouchEvent) => {
    setTouchEnd(e.targetTouches[0].clientX);
  };
  
  const handleTouchEnd = () => {
    if (!touchStart || !touchEnd) return;
    const distance = touchStart - touchEnd;
    const isLeftSwipe = distance > 50;
    const isRightSwipe = distance < -50;
    
    if (isLeftSwipe) onSwipeLeft();
    if (isRightSwipe) onSwipeRight();
  };
};
```

### 3. å­¦ç¿’åŠ¹æœå‘ä¸ŠUIè¦ç´ 

#### ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
```typescript
const LearningProgress = ({ progress, streak }: Props) => (
  <div className="learning-progress">
    <CircularProgress value={progress} size={120}>
      <div className="progress-content">
        <span className="progress-value">{progress}%</span>
        <span className="progress-label">å®Œäº†</span>
      </div>
    </CircularProgress>
    
    {streak > 0 && (
      <div className="streak-badge">
        <FireIcon />
        <span>{streak}æ—¥é€£ç¶š</span>
      </div>
    )}
  </div>
);
```

#### é”æˆæ„Ÿã‚’æ¼”å‡ºã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
```typescript
const achievementAnimation = keyframes`
  0% { transform: scale(0); opacity: 0; }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); opacity: 1; }
`;

const AchievementBadge = styled.div`
  animation: ${achievementAnimation} 0.6s ease-out;
  
  /* ç´™å¹é›ªã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
  &.celebrated {
    &::after {
      content: '';
      position: absolute;
      inset: 0;
      background-image: url('/confetti.gif');
      pointer-events: none;
      animation: fadeOut 3s forwards;
    }
  }
`;
```

### 4. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

#### ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚°ãƒªãƒƒãƒ‰
```css
.app-container {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1rem;
  padding: 1rem;
  
  /* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆï¼ˆiPadï¼‰ */
  @media (min-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
    padding: 2rem;
  }
  
  /* ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ— */
  @media (min-width: 1024px) {
    grid-template-columns: repeat(3, 1fr);
    max-width: 1200px;
    margin: 0 auto;
  }
}
```

### 5. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å®Ÿè£…

#### ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†
```typescript
const useFocusTrap = (ref: RefObject<HTMLElement>) => {
  useEffect(() => {
    const element = ref.current;
    if (!element) return;
    
    const focusableElements = element.querySelectorAll(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
    );
    
    const firstFocusable = focusableElements[0] as HTMLElement;
    const lastFocusable = focusableElements[focusableElements.length - 1] as HTMLElement;
    
    const handleTabKey = (e: KeyboardEvent) => {
      if (e.key === 'Tab') {
        if (e.shiftKey && document.activeElement === firstFocusable) {
          lastFocusable.focus();
          e.preventDefault();
        } else if (!e.shiftKey && document.activeElement === lastFocusable) {
          firstFocusable.focus();
          e.preventDefault();
        }
      }
    };
    
    element.addEventListener('keydown', handleTabKey);
    firstFocusable?.focus();
    
    return () => element.removeEventListener('keydown', handleTabKey);
  }, [ref]);
};
```

### 6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### ç”»åƒæœ€é©åŒ–
```typescript
const OptimizedImage = ({ src, alt, ...props }: ImageProps) => {
  const [isIntersecting, setIsIntersecting] = useState(false);
  const imgRef = useRef<HTMLImageElement>(null);
  
  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setIsIntersecting(true);
          observer.disconnect();
        }
      },
      { threshold: 0.1 }
    );
    
    if (imgRef.current) {
      observer.observe(imgRef.current);
    }
    
    return () => observer.disconnect();
  }, []);
  
  return (
    <picture>
      <source srcSet={`${src}.webp`} type="image/webp" />
      <img
        ref={imgRef}
        src={isIntersecting ? src : undefined}
        alt={alt}
        loading="lazy"
        {...props}
      />
    </picture>
  );
};
```

### 7. ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆ

#### æ„å‘³ã®ã‚ã‚‹ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³
```css
/* ãƒšãƒ¼ã‚¸é·ç§» */
.page-transition {
  animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* ã‚¹ã‚±ãƒ«ãƒˆãƒ³ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
.skeleton {
  background: linear-gradient(90deg, 
    var(--gray-100) 25%, 
    var(--gray-200) 50%, 
    var(--gray-100) 75%
  );
  background-size: 200% 100%;
  animation: loading 1.5s ease-in-out infinite;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}
```

---

ã“ã®æŠ€è¡“è¨­è¨ˆæ›¸ã«åŸºã¥ã„ã¦ã€æ‰¿èªã•ã‚ŒãŸè¦ä»¶å®šç¾©ã‚’ç¢ºå®Ÿã«å®Ÿè£…ã§ãã‚‹å…·ä½“çš„ãªæŠ€è¡“åŸºç›¤ãŒæ•´ã„ã¾ã—ãŸã€‚æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ã€ã“ã®è¨­è¨ˆã‚’åŸºã«è©³ç´°ãªå®Ÿè£…ã‚¿ã‚¹ã‚¯ã‚’ç­–å®šã—ã¾ã™ã€‚